<!DOCTYPE html>
<html lang="ru" data-vue-meta="%7B%22lang%22:%7B%22ssr%22:%22ru%22%7D%7D">
<head >
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
  <title>Как Tesla обучает автопилот / Хабр</title>
  <style>
    /* cyrillic-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSxf6TF0.woff2) format('woff2');
      unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
    }

    /* cyrillic */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveQhf6TF0.woff2) format('woff2');
      unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
    }

    /* latin-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSBf6TF0.woff2) format('woff2');
      unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
    }

    /* latin */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveRhf6.woff2) format('woff2');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
    }
  </style>
  <link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/app.c0af73e7.js" as="script">
  <link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css">
  <script>window.i18nFetch = new Promise((res, rej) => {
          const xhr = new XMLHttpRequest();
          xhr.open('GET', '/js/i18n/ru-compiled.85eb77f0b17c8235e7b64b9f81ea5ec2.json');
          xhr.responseType = 'json';
          xhr.onload = function(e) {
            if (this.status === 200) {
              res({ru: xhr.response});
            } else {
              rej(e);
            }
          };
          xhr.send();
        });</script>
  
  <script data-vue-meta="ssr" src="/js/ads.js" onload="window['zhY4i4nJ9K'] = true" data-vmid="checkad"></script><script data-vue-meta="ssr" type="application/ld+json" data-vmid="ldjson-schema">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/habr.com\/ru\/post\/450796\/"},"headline":"Как Tesla обучает автопилот","datePublished":"2019-05-13T09:36:14+03:00","dateModified":"2019-05-15T23:11:50+03:00","author":{"@type":"Person","name":"Andrei Odue"},"publisher":{"@type":"Organization","name":"Habr","logo":{"@type":"ImageObject","url":"https:\/\/habrastorage.org\/webt\/a_\/lk\/9m\/a_lk9mjkccjox-zccjrpfolmkmq.png"}},"description":"Расшифровка 2-й части Tesla Autonomy Investor Day. Цикл обучения автопилота, инфраструктура сбора данных, автоматическая разметка данных, подражание водителям-...","url":"https:\/\/habr.com\/ru\/post\/450796\/#post-content-body","about":["h_bigdata","h_machine_learning","h_artificial_intelligence","h_transport","h_futurenow","f_develop","f_popsci"],"image":["https:\/\/habrastorage.org\/webt\/vc\/ch\/lx\/vcchlxqf5blytupr3nsndhmmgay.png","https:\/\/habrastorage.org\/webt\/lu\/-b\/-u\/lu-b-ufhozioprg2nvebadsk4zs.png","https:\/\/habrastorage.org\/webt\/x7\/sy\/zq\/x7syzqa6mvf_64j6nsk8dovzyww.png","https:\/\/habrastorage.org\/webt\/eq\/wa\/wo\/eqwawo_3ky3vffm_hkkheyrhmlq.png","https:\/\/habrastorage.org\/webt\/_9\/4u\/x2\/_94ux28ucicihvbggphmoqc5i0y.png","https:\/\/habrastorage.org\/webt\/e5\/ew\/d3\/e5ewd3fhqw_ebegpk0heamyjafk.png","https:\/\/habrastorage.org\/webt\/k4\/og\/1f\/k4og1fzgiwwt6jy_rwcefm3fndm.png","https:\/\/habrastorage.org\/webt\/ob\/he\/xw\/obhexwtzhagxn7n_z0ildcfzyl8.png","https:\/\/habrastorage.org\/webt\/2k\/3r\/7a\/2k3r7as1159puh5ad4bf3fwrltc.png","https:\/\/habrastorage.org\/webt\/8u\/kj\/h7\/8ukjh7k3qw7-sv469pyhnnbwhi0.png","https:\/\/habrastorage.org\/webt\/7h\/st\/qk\/7hstqk7ygew-tfoo_ibersaw86s.png","https:\/\/habrastorage.org\/webt\/ms\/d0\/oi\/msd0oiytsgapqj3dczs6s_hpocc.png","https:\/\/habrastorage.org\/webt\/yt\/xh\/uj\/ytxhujmzul8r8dpqwido3fr_rns.png","https:\/\/habrastorage.org\/webt\/aa\/ne\/2x\/aane2xostifrgw-xjzwcklq-zbm.png","https:\/\/habrastorage.org\/webt\/zl\/ze\/az\/zlzeazzv1wrzsxbntqq5wtw0-50.png","https:\/\/habrastorage.org\/webt\/jk\/-g\/y4\/jk-gy4iyujnhhwpmzb0lcwpggci.png","https:\/\/habrastorage.org\/webt\/x0\/zy\/zx\/x0zyzxkrebaxgrqwu3xdxuldf9u.png","https:\/\/habrastorage.org\/webt\/-g\/1h\/i8\/-g1hi870mojfe0cnotbafoab73u.png","https:\/\/habrastorage.org\/webt\/vq\/_5\/h-\/vq_5h-j22m3xlryz5aszlqqwls8.png","https:\/\/habrastorage.org\/webt\/oc\/ft\/4s\/ocft4sltp3pprppnnk5y0jsj0rs.png","https:\/\/habrastorage.org\/webt\/gl\/sq\/-q\/glsq-qyu337vx5gcd3bycvqaffu.png","https:\/\/habrastorage.org\/webt\/ns\/ld\/x0\/nsldx0ejkyg1fvxoy-_7id-uds4.png","https:\/\/habrastorage.org\/webt\/ih\/pp\/je\/ihppjemgjkcaefowadynpdtu5le.png","https:\/\/habrastorage.org\/webt\/ll\/vt\/qy\/llvtqyhtg50ssityr07udz-ssqs.png","https:\/\/habrastorage.org\/webt\/5q\/aq\/b0\/5qaqb0qjwt-a7c6tpihpswc_zba.png","https:\/\/habrastorage.org\/webt\/1t\/io\/en\/1tioensdyfmt5eei36zaezrk1py.png"]}</script>
  <script src="//www.googletagservices.com/tag/js/gpt.js" async></script>
  <style>.grecaptcha-badge{visibility: hidden;}</style>
  <meta name="habr-version" content="2.49.0">
  
  <meta data-vue-meta="ssr" property="fb:app_id" content="444736788986613"><meta data-vue-meta="ssr" property="fb:pages" content="472597926099084"><meta data-vue-meta="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-meta="ssr" name="twitter:site" content="@habr_eng"><meta data-vue-meta="ssr" property="og:title" content="Как Tesla обучает автопилот" data-vmid="og:title"><meta data-vue-meta="ssr" name="twitter:title" content="Как Tesla обучает автопилот" data-vmid="twitter:title"><meta data-vue-meta="ssr" name="aiturec:title" content="Как Tesla обучает автопилот" data-vmid="aiturec:title"><meta data-vue-meta="ssr" name="description" content="Расшифровка 2-й части Tesla Autonomy Investor Day. Цикл обучения автопилота, инфраструктура сбора данных, автоматическая разметка данных, подражание водителям-людям, определение расстояния по..." data-vmid="description"><meta data-vue-meta="ssr" itemprop="description" content="Расшифровка 2-й части Tesla Autonomy Investor Day. Цикл обучения автопилота, инфраструктура сбора данных, автоматическая разметка данных, подражание водителям-людям, определение расстояния по..." data-vmid="description:itemprop"><meta data-vue-meta="ssr" property="og:description" content="Расшифровка 2-й части Tesla Autonomy Investor Day. Цикл обучения автопилота, инфраструктура сбора данных, автоматическая разметка данных, подражание водителям-людям, определение расстояния по..." data-vmid="og:description"><meta data-vue-meta="ssr" name="twitter:description" content="Расшифровка 2-й части Tesla Autonomy Investor Day. Цикл обучения автопилота, инфраструктура сбора данных, автоматическая разметка данных, подражание водителям-людям, определение расстояния по..." data-vmid="twitter:description"><meta data-vue-meta="ssr" property="aiturec:description" content="Расшифровка 2-й части Tesla Autonomy Investor Day. Цикл обучения автопилота, инфраструктура сбора данных, автоматическая разметка данных, подражание водителям-людям, определение расстояния по..." data-vmid="aiturec:description"><meta data-vue-meta="ssr" itemprop="image" content="https://habr.com/share/publication/450796/94c8ce5e2078c2c1f4914f2d7cbd3880/" data-vmid="image:itemprop"><meta data-vue-meta="ssr" property="og:image" content="https://habr.com/share/publication/450796/94c8ce5e2078c2c1f4914f2d7cbd3880/" data-vmid="og:image"><meta data-vue-meta="ssr" property="aiturec:image" content="https://habr.com/share/publication/450796/94c8ce5e2078c2c1f4914f2d7cbd3880/" data-vmid="aiturec:image"><meta data-vue-meta="ssr" name="twitter:image" content="https://habr.com/share/publication/450796/94c8ce5e2078c2c1f4914f2d7cbd3880/" data-vmid="twitter:image"><meta data-vue-meta="ssr" property="vk:image" content="https://habr.com/share/publication/450796/94c8ce5e2078c2c1f4914f2d7cbd3880/" data-vmid="vk:image"><meta data-vue-meta="ssr" property="aiturec:item_id" content="450796" data-vmid="aiturec:item_id"><meta data-vue-meta="ssr" property="aiturec:datetime" content="2019-05-13T06:36:14.000Z" data-vmid="aiturec:datetime"><meta data-vue-meta="ssr" property="og:type" content="article" data-vmid="og:type"><meta data-vue-meta="ssr" property="og:locale" content="ru_RU" data-vmid="og:locale"><meta data-vue-meta="ssr" property="og:image:width" content="1200" data-vmid="og:image:width"><meta data-vue-meta="ssr" property="og:image:height" content="630" data-vmid="og:image:height">
  <link data-vue-meta="ssr" href="https://habr.com/ru/rss/post/450796/?fl=ru" type="application/rss+xml" title="" rel="alternate" name="rss"><link data-vue-meta="ssr" href="https://habr.com/ru/post/450796/" rel="canonical" data-vmid="canonical"><link data-vue-meta="ssr" data-vmid="hreflang"><link data-vue-meta="ssr" image_src="image" href="https://habr.com/share/publication/450796/94c8ce5e2078c2c1f4914f2d7cbd3880/" data-vmid="image:href"><link data-vue-meta="ssr" rel="amphtml" href="https://habr.com/ru/amp/post/450796/">
  <meta name="apple-mobile-web-app-status-bar-style" content="#303b44">
  <meta name="msapplication-TileColor" content="#629FBC">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="16x16"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-16.png"
  >
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="32x32"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-32.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="76x76"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-76.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="120x120"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="152x152"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-152.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="180x180"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-180.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="256x256"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-256.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1136x640.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2436x1125.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1792x828.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_828x1792.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1334x750.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2208x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1125x2436.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2208.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2732x2048.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2688x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2224x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_750x1334.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x2732.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2388x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2224.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_640x1136.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2388.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x1536.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1536x2048.png"
  >
  <link
    rel="mask-icon"
    color="#77a2b6"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.svg"
  >
  <link
    crossorigin="use-credentials"
    href="/manifest.webmanifest"
    rel="manifest"
  >
</head>
<body>


<div id="app" data-server-rendered="true" data-async-called="true"><div class="tm-layout__wrapper"><!----> <div></div> <!----> <header class="tm-header"><div class="tm-page-width"><div class="tm-header__container"><!----> <span class="tm-header__logo-wrap"><a href="/ru/" class="tm-header__logo tm-header__logo_ru"><svg height="16" width="16" class="tm-svg-img tm-header__icon"><title>Хабр</title> <use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a> <span class="tm-header__beta-sign" style="display:none;">β</span></span> <div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#arrow-down"></use></svg></button></div> <!----></div> <a href="/ru/sandbox/start/" class="tm-header__become-author-btn">
            Как стать автором
          </a> <div class="tm-feature tm-header__feature tm-feature_variant-inline"><!----></div> <!----> <!----></div></div></header> <div class="tm-layout"><div class="tm-page-progress-bar"></div> <div data-menu-sticky="true" class="tm-base-layout__header tm-base-layout__header_is-sticky"><div class="tm-page-width"><div class="tm-base-layout__header-wrapper"><div class="tm-main-menu"><div class="tm-main-menu__section"><nav class="tm-main-menu__section-content"><!----> <a href="/ru/all/" class="tm-main-menu__item">
        Все потоки
      </a> <a href="/ru/flows/develop/" class="tm-main-menu__item">
          Разработка
        </a><a href="/ru/flows/admin/" class="tm-main-menu__item">
          Администрирование
        </a><a href="/ru/flows/design/" class="tm-main-menu__item">
          Дизайн
        </a><a href="/ru/flows/management/" class="tm-main-menu__item">
          Менеджмент
        </a><a href="/ru/flows/marketing/" class="tm-main-menu__item">
          Маркетинг
        </a><a href="/ru/flows/popsci/" class="tm-main-menu__item">
          Научпоп
        </a></nav></div></div> <div class="tm-header-user-menu tm-base-layout__user-menu"><a href="/ru/search/" class="tm-header-user-menu__item tm-header-user-menu__search"><svg height="24" width="24" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search tm-header-user-menu__icon_dark"><title>Поиск</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#search"></use></svg></a> <!----> <!----> <!----> <div class="tm-header-user-menu__item tm-header-user-menu__user_desktop"><div class="tm-dropdown"><div class="tm-dropdown__head"><svg height="24" width="24" data-test-id="menu-toggle-guest" class="tm-svg-img tm-header-user-menu__icon"><title>Профиль</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#header-user"></use></svg> <!----></div> <!----></div> <!----></div> <!----></div></div></div></div> <!----> <div class="tm-page-width"></div> <main class="tm-layout__container"><div hl="ru" data-async-called="true" class="tm-page"><div class="tm-page-width"><!----> <div class="tm-page__wrapper"><div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down"><div class="pull-down__header" style="height:0px;"><div class="pull-down__content" style="bottom:10px;"><svg height="24" width="24" class="tm-svg-img pull-down__arrow"><title>Обновить</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#pull-arrow"></use></svg></div></div> <div class="tm-article-presenter"> <div class="tm-article-presenter__body"><div class="tm-misprint-area"><div class="tm-misprint-area__wrapper"><article class="tm-article-presenter__content tm-article-presenter__content_narrow"><div class="tm-article-presenter__header"> <div class="tm-article-snippet tm-article-presenter__snippet"><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a href="/ru/users/androude/" title="androude" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" loading="lazy" src="//habrastorage.org/r/w32/getpro/habr/avatars/f2f/db4/6b0/f2fdb46b0d5d6ff9e7cac5129ed7e651.jpg" width="24" class="tm-entity-image__pic"></div></a> <span class="tm-user-info__user"><a href="/ru/users/androude/" class="tm-user-info__username">
      androude
    </a> </span></span> <span class="tm-article-snippet__datetime-published"><time datetime="2019-05-13T06:36:14.000Z" title="2019-05-13, 09:36">13  мая  2019 в 09:36</time></span></div> <!----></div> <h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1"><span>Как Tesla обучает автопилот</span></h1> <div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/bigdata/" class="tm-article-snippet__hubs-item-link"><span>Big Data</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/machine_learning/" class="tm-article-snippet__hubs-item-link"><span>Машинное обучение</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/artificial_intelligence/" class="tm-article-snippet__hubs-item-link"><span>Искусственный интеллект</span> <!----></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/transport/" class="tm-article-snippet__hubs-item-link"><span>Транспорт</span> <!----></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/futurenow/" class="tm-article-snippet__hubs-item-link"><span>Будущее здесь</span> <!----></a></span></div> <div class="tm-article-snippet__labels"><div class="tm-article-snippet__label"><span>
        Перевод
      </span></div></div> <!----> <!----></div></div> <div class="tm-article-presenter__origin"><a href="https://youtu.be/Ucp0TTmvqOE" target="_blank" class="tm-article-presenter__origin-link">
                Автор оригинала:
                <span>
                  Tesla
                </span></a></div> <div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-1"><div xmlns="http://www.w3.org/1999/xhtml"><em><img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/vc/ch/lx/vcchlxqf5blytupr3nsndhmmgay.png"/><br/>
<br/>
Расшифровка 2-й части Tesla Autonomy Investor Day. Цикл обучения автопилота, инфраструктура сбора данных, автоматическая разметка данных, подражание водителям-людям, определение расстояния по видео, sensor-supervision и многое другое.</em><br/>
<a name="habracut"></a><br/>
<em><a href="https://habr.com/ru/post/450500/">Первая часть — разработка Full Self-Driving Computer (FSDC)</a>.</em><br/>
<br/>
<strong> Хост: </strong> FSDC может работать с очень сложными нейронными сетями для обработки изображений. Пора поговорить о том, как мы получаем изображения и как мы их анализируем. У нас здесь старший директор AI в Tesla — Андрей Карпаты, который объяснит вам все это.<br/>
<br/>
<strong> Андрей: </strong> Я занимаюсь обучением нейронных сетей примерно десять лет, и вот уже 5-6 лет для промышленного применения. В том числе в таких известных учреждениях как Стэнфорд, Open AI и Google. Это множество нейронных сетей не только для обработки изображений, но и естественного языка. Я проектировал архитектуры, которые объединяют эти две модальности для своей докторской диссертации.<br/>
<br/>
В Стэнфорде я вел курс по деконволюционным нейросетям. Я был основным преподавателем и разработал всю учебную программу к нему. Вначале у меня было около 150 студентов, в течение следующих двух или трех лет число студентов выросло до 700. Это очень популярный курс, один из самых больших и успешных курсов в Стэнфорде прямо сейчас.<br/>
<br/>
<strong> Илон: </strong> Андрей действительно один из лучших специалистов по машинному зрению в мире. Возможно, лучший.<br/>
<br/>
<strong> Андрей: </strong> Спасибо. Привет всем. Пит рассказал вам о чипе, который мы разработали специально для нейросетей в автомобиле. Моя команда отвечает за обучение этих нейросетей. Это включает в себя сбор данных, обучение, и частично, развертывание.<br/>
<br/>
Что делают нейронные сети в автомобиле. В машине восемь камер, которые снимают видео. Нейронные сети смотрят эти видео, обрабатывают их и делают прогнозы относительно того, что они видят. Нас интересует дорожная разметка, участники движения, прочие объекты и расстояния до них, проезжая часть, светофоры, дорожные знаки и так далее.<br/>
<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/lu/-b/-u/lu-b-ufhozioprg2nvebadsk4zs.png"/><br/>
<br/>
Мое выступление можно разделить на три части. Сначала я кратко ознакомлю вас с нейронными сетями и с тем, как они работают и как их обучают. Это необходимо сделать, чтобы во второй части было понятно, почему так важно что у нас есть огромный парк автомобилей Tesla (fleet). Почему это является ключевым фактором, позволяющим обучать нейронные сети, которые эффективно работают на дорогах. В третьей части я расскажу о машинном зрении, лидаре и о том, как оценивать расстояние используя только видео.<br/>
<br/>
<h2>Как работают нейронные сети</h2><br/>
<em>(Тут мало нового, можно пропустить и перейти к следующему заголовку)</em><br/>
<br/>
Основная задача, которую сети решают в автомобиле это распознавание образов. Для нас, людей, это очень простая задача. Вы смотрите на изображения и видите виолончель, лодку, игуану или ножницы. Очень легко и просто для вас, но не для компьютера. Причина в том, что эти изображения для компьютера являются просто массивом пикселей, где каждый пиксель это значение яркости в этой точке. Вместо того, чтобы просто видеть изображение, компьютер получает миллион чисел в массиве.<br/>
<br/>
<strong> Илон: </strong> Матрица, если хотите. Реально матрица.<br/>
<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/x7/sy/zq/x7syzqa6mvf_64j6nsk8dovzyww.png"/><br/>
<br/>
<strong> Андрей: </strong> Да. Мы должны перейти от этой сетки пикселей и значений яркости к высокоуровневым понятиям, таким как игуана и так далее. Как вы можете себе представить, это изображение игуаны имеет определенный шаблон яркости. Но игуаны могут быть изображены по-разному, в разных позах, в разных условиях освещения, на разном фоне. Вы можете найти множество разных изображений игуаны и мы должны распознать её в любых условиях.<br/>
<br/>
Причина, по которой вы и я легко с этим справляемся — у нас внутри огромная нейронная сеть, которая обрабатывает изображения. Свет попадает на сетчатку и направляется в заднюю часть вашего мозга к зрительной коре. Кора головного мозга состоит из множества нейронов, которые связаны друг с другом и выполняют распознавание образов.<br/>
<br/>
Последние лет пять, современные подходы к обработке изображений с использованием компьютеров также начали использовать нейронные сети, но в данном случае — искусственные нейронные сети. Искусственные нейронные сети представляют собой грубое математическое приближение зрительной коры. Здесь тоже есть нейроны, они связаны друг с другом. Типичная нейронная сеть включает десятки или сотни миллионов нейронов, и каждый нейрон имеет тысячи связей.<br/>
<br/>
Мы можем взять нейронную сеть и показать ей изображения, например нашу игуану, и сеть сделает прогноз (prediction), что она видит. Сначала нейронные сети инициализируются совершенно случайно, все веса связей между нейронами — случайные числа. Поэтому прогноз сети тоже будет случайным. Может оказаться, что сеть думает что это, вероятно, лодка. Во время тренировки мы знаем и отмечаем, что на изображении игуана. Мы попросту говорим, что хотели бы, чтобы вероятность игуаны для этого изображения увеличилась, а вероятность всего остального уменьшилась. Затем используется математический процесс, называемый методом обратного распространения ошибки. Стохастический градиентный спуск, который позволяет нам распространять сигнал по связям и обновлять их веса. Обновим вес каждого из этих соединений совсем немного, и как только обновление будет завершено, вероятность игуаны для этого изображения немного возрастет, а вероятность других ответов снизится.<br/>
<br/>
Конечно, мы делаем это не с одним единственным изображением. У нас есть большой набор размеченных данных. Обычно это миллионы изображений, тысячи меток или около того. Процесс обучения повторяется снова и снова. Вы показываете компьютеру изображение, он сообщает вам свое мнение, затем вы говорите правильный ответ, и сеть немного настраивается. Вы повторяете это миллионы раз, иногда показываете одно и то же изображение сотни раз. Обучение обычно занимает несколько часов или несколько дней.<br/>
<br/>
Теперь кое-что контр-интуитивное о работе нейросетей. Им нужно действительно много примеров. Это не просто уместить в голове, но они реально начинают с нуля, они ничего не знают. Вот пример — милая собачка, и вы, вероятно, не знаете ее породы. Это японский спаниель. Мы с вами смотрим на эту картинку и мы видим японского спаниеля. Мы можем сказать: «ОК я понял, теперь я знаю, как выглядит японский спаниель». Если я покажу вам еще несколько изображений других собак, вы сможете найти среди них других японских спаниелей. Вам понадобился всего один пример, но компьютеры так не могут. Им нужна куча данных о японских спаниелях, тысячи примеров, в разных позах, разных условиях освещения, на разном фоне и т.д. Вам нужно показать компьютеру, как выглядит японский спаниель с разных точек зрения. И ему действительно нужны все эти данные, противном случае компьютер не сможет выучить нужный шаблон.<br/>
<br/>
<h2>Разметка изображений для автопилота</h2><br/>
Так как же это все относится к автономному вождению. Нас не очень заботят породы собак. Может быть, будут заботить в будущем. Но сейчас нас интересует дорожная разметка, объекты на дороге, где они находятся, куда мы можем ехать и так далее. У нас теперь нет просто меток вроде «игуана», но у нас есть изображения дороги, и нас интересует, например, дорожная разметка. Человек смотрит на изображение и с помощью мыши отмечает её.<br/>
<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/eq/wa/wo/eqwawo_3ky3vffm_hkkheyrhmlq.png"/><br/>
<br/>
У нас есть возможность обратится к автомобилям Tesla и попросить еще больше фотографий. Если запросить случайные фото, вы получите изображения где, как правило, машина просто едет по шоссе. Это будет случайный набор данных и мы разметим его.<br/>
<br/>
Если вы будете размечать только случайные наборы, ваша сеть выучит простую, часто встречающуюся дорожную ситуацию и будет работать хорошо только в ней. Когда вы покажете ей немного другой пример, скажем, изображение поворота дороги в жилом районе. Ваша сеть может дать неправильный результат. Она скажет «хорошо, я видела много раз, дорога идет прямо». <br/>
<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/_9/4u/x2/_94ux28ucicihvbggphmoqc5i0y.png"/><br/>
<br/>
Конечно, это совсем неверно. Но мы не можем винить нейронную сеть. Она не знает, имеет ли значение дерево слева, автомобиль справа, или те здания на заднем плане. Сеть не знает ничего об этом. Мы с вами знаем, значение имеет, линия разметки и тот факт, что она немного сворачивает в сторону. Сеть должна учесть это, но нет механизма, с помощью которого мы можем просто сказать нейронной сети, что вот эти штрихи дорожной разметки действительно имеют значение. Единственный инструмент в наших руках это размеченные данные.<br/>
<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/e5/ew/d3/e5ewd3fhqw_ebegpk0heamyjafk.png"/><br/>
<br/>
Мы берем изображения, на которых сеть ошибается, и размечаем их правильно. В данном случае мы отметим поворачивающую разметку. Затем нужно передать множество подобных изображений в нейронную сеть. И со временем она накопит знания и научится понимать этот шаблон, понимать, что вот эта часть изображения не играет роли, а вот эта разметка очень даже важна. Сеть научится правильно находить полосу движения.<br/>
<br/>
Важен не только размер набора обучающих данных. Нам нужны не просто миллионы изображений. Нужно проделать немалую работу, чтобы покрыть пространство ситуаций, которые автомобиль может встретить на дорогах. Нужно научить компьютер работать ночью и в дождь. Дорога может отражать свет как зеркало, освещенность может варьироваться в больших пределах, изображения будут выглядеть очень по-разному.<br/>
<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/k4/og/1f/k4og1fzgiwwt6jy_rwcefm3fndm.png"/><br/>
<br/>
Мы должны научить компьютер как обращаться с тенями, развилками, с крупными объектами, занимающими большую часть изображения. Как работать с туннелями или в зоне ремонта дороги. И во всех этих случаях нет прямого механизма сообщить сети, что делать. У нас есть только огромный набор данных. Мы можем взять изображения, разметить, и обучать сеть пока она не начнет понимать их структуру.<br/>
<br/>
Большие и разнообразные наборы данных помогают сетям работать очень хорошо. Это не наше открытие. Эксперименты и исследования Google, Facebook, Baidu, Deepmind от Alphabet. Все показывают схожие результаты — нейронные сети действительно любят данные, любят количество и разнообразие. Добавляете больше данных и точность нейронных сетей растет.<br/>
<br/>
<h2>Вам придется разработать автопилот, чтобы симулировать поведение машин в симуляции</h2><br/>
Ряд специалистов отмечают, что мы могли бы использовать симуляцию, чтобы заполучить необходимые данные в нужном масштабе. В Tesla мы не раз задавались этим вопросом. У нас есть собственный симулятор. Мы широко используем симуляцию для разработки и оценки программного обеспечения. Мы использовали её и для обучения довольно успешно. Но в итоге, когда дело доходит до обучающих данных для нейронных сетей, ничто не заменит реальных данных. Симуляции имеют проблемы с моделированием внешнего вида, физики и поведения участников.<br/>
<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/ob/he/xw/obhexwtzhagxn7n_z0ildcfzyl8.png"/><br/>
<br/>
Реальный мир подкидывает нам кучу неожиданных ситуаций. Сложные условия со снегом, деревьями, ветром. Различные визуальные артефакты, которые трудно смоделировать. Зоны ремонта дороги, кусты, болтающиеся на ветру полиэтиленовые пакеты. Там может быть много людей, взрослые, дети и животные вперемешку. Моделирование поведения и взаимодействия всего этого оказывается совершенно неразрешимой задачей.<br/>
<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/2k/3r/7a/2k3r7as1159puh5ad4bf3fwrltc.png"/><br/>
<br/>
Речь идет не о передвижении одного пешехода. Речь идет о том, как пешеходы реагируют друг на друга, и как машины реагируют друг на друга, как они реагируют на вас. Все это очень сложно симулировать. Вам нужно сначала разработать автопилот, только чтобы симулировать поведение автомобилей в симуляции.<br/>
<br/>
Это правда сложно. Это могут быть собаки, экзотические животные, а иногда это даже не то, что вы не можете симулировать, это то, что просто никогда не придет к вам в голову. Я не знал, что грузовик может перевозить грузовик, который везет грузовик, который везет еще один грузовик. Но в реальном мире происходит и это и много других вещей, которые трудно придумать. Разнообразие, которое я вижу в данных, поступающих от автомобилей, просто безумно по отношению к тому, что мы имеем в симуляторе. Хотя у нас хороший симулятор.<br/>
<br/>
<strong> Илон: </strong> Симуляция — это, как если бы вы сами себе придумывали домашнее задание. Если вы знаете что будете симулировать, Окей, что вы конечно разберетесь с этим. Но как сказал Андрей — ты не знаешь, чего ты не знаешь. Мир очень странный, в нем миллионы особых случаев. Если кто-то создаст симуляцию вождения, которая будет точно воспроизводить реальность, это само по себе станет монументальным достижением человечества. Но никто не может этого сделать. Просто нет способа.<br/>
<br/>
<h2>Флот — ключевой источник данных для обучения</h2><br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/8u/kj/h7/8ukjh7k3qw7-sv469pyhnnbwhi0.png"/><br/>
<br/>
<strong> Андрей: </strong> Чтобы нейронные сети работали хорошо вам нужен большой, разнообразный и реальный набор данных. И если он у вас есть, вы сможете обучить свою нейронную сеть и она будет работать очень хорошо. Так почему Tesla такая особенная в этом отношении? Ответ конечно же — флот (fleet, автопарк Tesla). Мы можем собирать данные со всех автомобилей Tesla и использовать их для обучения.<br/>
<br/>
Давайте рассмотрим конкретный пример улучшения работы детектора объектов. Это даст вам представление о том, как мы обучаем нейронные сети, как мы их применяем, и как они становятся лучше с течением времени.<br/>
<br/>
Обнаружение объектов одна из важных для нас задач. Нам нужно выделить габариты автомобилей и других объектов, чтобы отслеживать их и понимать как они могут перемещаться. Мы можем попросить людей разметить изображения. Люди скажут: «вот машины, вот велосипеды» и так далее. И мы можем обучить нейронную сеть на этих данных. Но в некоторых случаях сеть будет делать неправильные прогнозы.<br/>
<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/7h/st/qk/7hstqk7ygew-tfoo_ibersaw86s.png"/><br/>
<br/>
Например, если мы наткнемся на ​​машину к которой сзади прикреплен велосипед, то наша нейронная сеть обнаружит 2 объекта — автомобиль и велосипед. Именно так она работала, когда я только пришел. И по-своему это правильно, потому что оба этих объекта действительно здесь присутствуют. Но планировщику автопилота нет никакого дела до того факта, что этот велосипед — отдельный объект, который перемещается вместе с автомобилем. Правда в том, что этот велосипед жестко прикреплен к автомобилю. С точки зрения объектов на дороге это один объект — один автомобиль. <br/>
<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/ms/d0/oi/msd0oiytsgapqj3dczs6s_hpocc.png"/><br/>
<br/>
Теперь мы хотели бы разметить множество подобных объектов как «один автомобиль». Наша команда использует следующий подход. Мы берем это изображение или несколько изображений, на которых присутствует такая модель. И у нас есть механизм машинного обучения, с помощью которого мы можем попросить флот предоставить нам примеры, которые выглядят так же. И флот присылает изображения в ответ.<br/>
<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/yt/xh/uj/ytxhujmzul8r8dpqwido3fr_rns.png"/><br/>
<br/>
Вот пример шести полученных изображений. Все они содержат велосипеды прикрепленные к автомобилям. Мы разметим их правильно и наш детектор станет работать лучше. Сеть начнет понимать, когда велосипед прикреплен к автомобилю, и что это один объект. Вы можете обучить сеть этому при условии, что у вас есть достаточное количество примеров. И именно так мы решаем подобные задачи.<br/>
<br/>
Я довольно много говорю о получении данных с автомобилей Tesla. И я хочу сразу сказать, что мы разрабатывали эту систему с самого начала с учетом конфиденциальности. Все данные, которые мы используем для обучения, анонимизированы.<br/>
<br/>
Флот присылает нам не только велосипеды на автомобилях. Мы постоянно ищем множество разных моделей. Например, мы ищем лодки — флот присылает изображения лодок на дорогах. Мы хотим изображения зон ремонта дороги, и флот присылает нам множество таких изображений со всего мира. Или например, мусор на дороге, это тоже очень важно. Флот присылает нам изображением шин, конусов, пластиковых пакетов и тому подобного на дороге.<br/>
<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/aa/ne/2x/aane2xostifrgw-xjzwcklq-zbm.png"/><br/>
<br/>
Мы можем заполучить достаточно изображений, правильно их разметить, и нейронная сеть научится работать с ними в реальном мире. Нам нужно, чтобы нейронная сеть понимала, что происходит и корректно реагировала.<br/>
<br/>
<h2>Неуверенность нейросети запускает сбор данных</h2><br/>
Процедура, которую мы повторяем снова и снова для обучения нейронной сети, выглядит следующим образом. Мы начали со случайного набора изображений полученных от флота. Мы размечаем изображения, обучаем нейронную сеть и загружаем её в автомобили. У нас есть механизмы, с помощью которых мы обнаруживаем неточности в работе автопилота. Если мы видим, что нейронная сеть не уверена или есть вмешательство водителя или другие события, происходит автоматическая отправка данных, на которых это произошло. <br/>
<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/zl/ze/az/zlzeazzv1wrzsxbntqq5wtw0-50.png"/><br/>
<br/>
Например, плохо распознается разметка в туннелях. Мы замечаем, что в туннелях есть проблема. Соответствующие изображения попадают в наши юнит-тесты, чтобы проблема не могла повториться позднее. Теперь, чтобы исправить проблему, нам нужно много обучающих примеров. Мы просим флот отправить нам больше изображений туннелей, правильно их размечаем, добавляем в обучающую выборку и переобучаем сеть, а затем загружаем в автомобили. Этот цикл повторяется снова и снова. Мы называем этот итеративный процесс data engine (машина данных? движок данных?). Включаем сеть в теневом режиме (shadow mode), обнаруживаем неточности, запрашиваем больше данных, включаем их в обучающую выборку. Мы делаем это для всех видов предсказаний наших нейронных сетей.<br/>
<br/>
<h2>Автоматическая разметка данных</h2><br/>
Я много говорил о ручной разметке изображений. Это затратный процесс, и по времени и финансово. Он может стоить слишком дорого. Я хочу рассказать о том, как здесь можно использовать флот. Ручная разметка это узкое место. Мы хотим просто передавать данные и размечать их автоматически. И для этого есть несколько механизмов.<br/>
<br/>
Как пример, один из наших недавних проектов — обнаружение перестроений. Вы едете по шоссе, кто-то едет слева или справа, и он перестраивается в вашу полосу.<br/>
<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/jk/-g/y4/jk-gy4iyujnhhwpmzb0lcwpggci.png"/><br/>
<br/>
Вот видео, где автопилот обнаруживает перестроение. Конечно, мы хотели бы обнаружить его как можно раньше. Подход к решению этой проблемы заключается в том, что мы не пишем код вроде: включен левый указатель поворота, включен правый указатель поворота, перемещался ли автомобиль по горизонтали с течением времени. Вместо этого мы используем автоматическое обучение с помощью флота.<br/>
<br/>
Как это работает. Мы просим флот присылать нам данные всякий раз, когда зафиксировано перестроение в нашу полосу. Затем мы перематываем время назад и автоматически помечаем, что этот автомобиль через 1.3 сек перестроится перед вами. Эти данные можно использовать для обучения нейронной сети. Таким образом нейронная сеть сама извлечет нужные признаки. Например, машина рыскает и затем перестраивается, или у нее включен сигнал поворота. Обо всем этом нейросеть узнает из автоматически размеченных примеров. <br/>
<br/>
<h2>Проверка в теневом режиме</h2><br/>
Мы просим флот автоматически присылать нам данные. Мы можем собрать полмиллиона изображений или около того, и на всех будут размечены перестроения. Мы обучаем сеть и загружаем её во флот. Но пока не включаем её полностью, а запускаем в теневом режиме. В этом режиме сеть постоянно делает прогнозы: «эй, я думаю, этот автомобиль собирается перестроиться». И мы ищем ошибочные прогнозы.<br/>
<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/x0/zy/zx/x0zyzxkrebaxgrqwu3xdxuldf9u.png"/><br/>
<br/>
Вот пример клипа, который мы получили из теневого режима. Здесь ситуация немного не очевидна, и сеть подумала, что автомобиль справа собирается перестроиться. И вы можете заметить, что он слегка заигрывает с линией разметки. Сеть среагировала на это, и предположила что автомобиль скоро окажется в нашей полосе. Но этого не произошло.<br/>
<br/>
Сеть работает в теневом режиме и делает прогнозы. Среди них есть ложноположительные и ложноотрицательные. Иногда сеть ошибочно реагирует, а иногда, пропускает события. Всё эти ошибки запускают сбор данных. Данные размечаются и включаются в обучение без дополнительных усилий. И мы не подвергаем людей опасности в этом процессе. Мы переобучаем сеть и снова используем теневой режим. Можем повторять так несколько раз, оценивая ложные срабатывания в реальной дорожной обстановке. Как только показатели нас устраивают, мы просто щелкаем переключатель и позволяем сети контролировать автомобиль.<br/>
<br/>
Мы запустили одну из первых версий детектора перестроений, примерно три месяца назад. Если вы заметили, что машина стала намного лучше обнаруживать перестроения — это и есть обучение с помощью флота в действии. И ни один человек не пострадал в этом процессе. Это просто много тренировок нейронных сетей, основанных на реальных данных, использование теневого режима и анализ результатов.<br/>
<br/>
<strong> Илон: </strong> По сути, все водители постоянно тренируют сеть. Не важно включен или выключен автопилот. Сеть обучается. Каждая миля, пройденная за машиной с оборудованием HW2.0 или выше, обучает сеть.<br/>
<br/>
<h2>Пока вы ведете машину, на самом деле вы размечаете данные</h2><br/>
<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/-g/1h/i8/-g1hi870mojfe0cnotbafoab73u.png"/><br/>
<br/>
<strong> Андрей: </strong> Другой интересный проект, который мы используем в схеме обучения флотом, это прогнозирование пути. Когда вы ведете машину, на самом деле, вы размечаете данные. Вы говорите нам, как вести машину в разной дорожной обстановке. Вот один из водителей повернул налево на перекрестке. У нас есть полное видео всех камер, и мы знаем, путь, который выбрал водитель. Мы также знаем какая была скорость и угол поворота рулевого колеса. Мы собираем все это вместе и понимаем путь, который выбрал человек в этой дорожной ситуации. И мы можем использовать это как обучение с учителем. Мы просто получаем нужный объем данных с флота, обучаем сеть на этих траекториях, и после этого нейронная сеть может прогнозировать путь.<br/>
<br/>
Это называют имитационным обучением (imitation learning). Мы берем траектории движения людей из реального мира и пытаемся подражать им. И мы снова можем применить наш итеративный подход.<br/>
<br/>
Вот пример предсказания пути в непростой дорожной обстановке. На видео мы накладываем прогноз сети. Зеленым выделен путь, по которому двигалась бы сеть.<br/>
<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/vq/_5/h-/vq_5h-j22m3xlryz5aszlqqwls8.png"/><br/>
<br/>
<strong> Илон: </strong> Безумие в том, что сеть предсказывает путь, который она даже не может видеть. С невероятно высокой точностью. Она не видит что за поворотом, но считает, что вероятность этой траектории чрезвычайно высока. И оказывается права. Сегодня вы увидите это в автомобилях, мы включим дополненное зрение, чтобы вы могли видеть разметку и прогнозы траектории, наложенные на видео. <br/>
<br/>
<strong> Андрей: </strong> На самом деле, под капотом происходит больше всего, и<br/>
<br/>
<strong> Илон: </strong> Вообще-то, это немного пугает (Андрей смеется).<br/>
<br/>
<strong> Андрей: </strong> Конечно, я пропускаю много деталей. Возможно, вы не захотите использовать для разметки всех водителей подряд, вы хотите подражать лучшим. И мы используем ряд способов, для подготовки этих данных. Интересно, что этот прогноз на самом деле является трехмерным. Это путь в трехмерном пространстве, который мы отображаем в 2D. Но у сети есть информация об уклоне, и это очень важно для вождения.<br/>
<br/>
Прогнозирование пути на данный момент уже работает в автомобилях. Кстати, когда вы проезжали развязку на шоссе, месяцев пять назад, ваша машина не умела справляться с этим. Теперь может. Это прогнозирование пути, в действии, в ваших автомобилях. Мы включили его некоторое время назад. И сегодня вы сможете увидеть, как это работает на перекрестках. Значительная часть обучения преодолению перекрестков, получена путем автоматической разметки данных.<br/>
<br/>
Я успел рассказать о ключевых компонентах обучения нейросети. Вам нужен большой разнообразный набор реальных данных. В Tesla мы получаем его с помощью флота. Мы используем data engine, теневой режим и автоматическую разметку данных с помощью флота. И мы можем масштабировать этот подход.<br/>
<br/>
<h2>Восприятие глубины по видео</h2><br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/oc/ft/4s/ocft4sltp3pprppnnk5y0jsj0rs.png"/><br/>
<br/>
В следующей части моего выступления расскажу о восприятии глубины с помощью зрения. Вам наверняка известно, что в автомобилях используются как минимум два типа сенсоров. Один — это видео камеры, работающие с яркостью, а другой — лидар, который используют многие компании. Лидар дает точечные измерения расстояния вокруг вас.<br/>
<br/>
Я хотел бы отметить, вы все приехали сюда, используя только свою нейронную сеть и зрение. Вы не стреляли лазерами из глаз и все равно оказались здесь.<br/>
<br/>
Ясно, что человеческая нейронная сеть извлекает расстояние и воспринимает мир трехмерным исключительно с помощью зрения. Она использует ряд приемов. Я кратко расскажу о некоторых из них. Например у нас два глаза, поэтому вы получаете два изображения мира впереди вас. Ваш мозг объединяет эту информацию, чтобы получить оценку расстояний, это делается с помощью триангуляции точек на двух изображениях. У многих животных глаза расположены по бокам и их поле зрения слабо пересекается. Эти животные используют движение (structure from motion). Они двигают головой, чтобы получить множество изображений мира из разных точек и также могут применять триангуляцию.<br/>
<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/gl/sq/-q/glsq-qyu337vx5gcd3bycvqaffu.png"/><br/>
<br/>
Даже с одним закрытым глазом и будучи совершенно неподвижным, вы сохраняете некоторое ощущение восприятия расстояния. Если вы закроете один глаз, вам не станет казаться, что я стал на два метра ближе или на сто метров дальше. Это потому что есть много сильных монокулярных приемов, которые также применяет ваш мозг. Например распространенная оптическая иллюзия, с двумя одинаковыми полосами на фоне рельс. Ваш мозг оценивает сцену и ожидает, что одна из них будет больше другой из-за исчезающих вдали линий рельс. Ваш мозг делает много подобного автоматически, и искусственные нейронные сети тоже так могут. <br/>
<br/>
Я приведу три примера как можно добиться восприятия глубины по видео. Один классический подход и два на основе нейронных сетей.<br/>
<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/ns/ld/x0/nsldx0ejkyg1fvxoy-_7id-uds4.png"/><br/>
<br/>
Мы можем взять видео клип в несколько секунд и воссоздать окружение в 3D, используя триангуляцию и методы стереозрения. Мы применяем аналогичные методы в автомобиле. Главное, что в сигнале действительно есть нужная информация, вопрос только в том чтобы ее извлечь.<br/>
<br/>
<h2>Разметка расстояния с помощью радара</h2><br/>
Как я сказал, нейронные сети являются очень мощным инструментом визуального распознавания. Если вы хотите, чтобы они распознавали расстояние, вам нужно разметить расстояния, и тогда сеть научится делать это. Ничто не ограничивает сети в способности прогнозировать расстояние, кроме наличия размеченных данных.<br/>
<br/>
Мы используем радар, направленный вперед. Этот радар измеряет и размечает расстояние до объектов, которые видит нейросеть. Вместо того, чтобы люди говорили вам «этот автомобиль находятся примерно в 25 метрах», вы можете разметить данные гораздо лучше с помощью сенсоров. Радар, очень хорошо работает на таком расстоянии. Вы размечаете данные и обучаете нейронную сеть. Если у вас достаточно данных, нейронная сеть будет очень хорошо предсказывать расстояние.<br/>
<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/ih/pp/je/ihppjemgjkcaefowadynpdtu5le.png"/><br/>
<br/>
На этом изображении кругами показаны объекты полученные радаром, а кубоиды — объекты полученные нейросетью. И если сеть работает хорошо, то на виде сверху, положения кубоидов должны совпадать с положением кружков, что мы и наблюдаем. Нейронные сети очень хорошо справляются с прогнозированием расстояния. Они могут выучить размеры разных транспортных средств, и по их размеру на изображении, довольно точно определять расстояние.<br/>
<br/>
<h2>Self-supervision</h2><br/>
Последний механизм, о котором я расскажу очень кратко, немного более технический. Есть лишь несколько статей, в основном в последний год или два, об этом подходе. Он называется Self-supervision.<br/>
<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/ll/vt/qy/llvtqyhtg50ssityr07udz-ssqs.png"/><br/>
<br/>
Что здесь происходит. Вы загружаете сырые не размеченные видео в нейронную сеть. И сеть все равно может учиться распознавать расстояние. Не вдаваясь в подробности, идея состоит в том, что нейронная сеть предсказывает расстояние в каждом кадре этого видео. У нас нет меток для проверки, но есть цель — согласованность во времени. Какое бы расстояние сеть ни предсказывала, она должна быть последовательной на протяжении всего видео. И единственный способ быть последовательным — предсказывать расстояние правильно. Сеть автоматически предсказывает глубину для всех пикселей. Мы сумели это воспроизвести, и это работает довольно хорошо.<br/>
<br/>
<h2>Мощное визуальное распознавание — обязательное условие для автопилота</h2><br/>
Подытожим. Люди используют зрение, никаких лазеров. Я хочу подчеркнуть, что мощное визуальное распознавание, абсолютно необходимо для автономного вождения. Нам нужны нейронные сети, которые действительно понимают окружающую обстановку.<br/>
<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/5q/aq/b0/5qaqb0qjwt-a7c6tpihpswc_zba.png"/><br/>
<br/>
Данные с лидара гораздо меньше насыщены информацией. Этот силуэт на дороге, это пластиковый пакет или шина? Лидар просто даст вам несколько точек, в то время как зрение может сказать вам, что это. А этот парень на велосипеде оглядывающийся назад, он пытается перестроиться в вашу полосу или едет прямо? В зоне ремонта дороги, что означают эти знаки и как я должен вести себя здесь? Да вся дорожная инфраструктура предназначена для визуального потребления. Все знаки, светофоры, все предназначено для зрения, вот где вся информация. И мы должны использовать её.<br/>
<br/>
Эта девушка увлеченная телефоном, она собирается ступить на проезжую часть? Ответы на подобные вопросы могут быть найдены только с помощью зрения и они необходимы для автопилота 4-5 уровня. И именно это мы разрабатываем в Tesla. Мы делаем это через крупномасштабное обучение нейронной сети, наш data engine и помощь флота.<br/>
<br/>
В этом отношении лидар — попытка срезать путь. Он обходит фундаментальную задачу машинного зрения, решение которой необходимо для автономного вождения. Он дает ложное чувство прогресса. Лидар хорошо годится только для быстрых демонстраций.<br/>
<br/>
<h2>Прогресс пропорционален частоте столкновений со сложными ситуациями в реальном мире</h2><br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/1t/io/en/1tioensdyfmt5eei36zaezrk1py.png"/><br/>
<br/>
Если бы я хотел бы уместить все сказанное на одном слайде, он выглядел бы так. Нам нужны системы 4-5 уровня, которые смогут обрабатывать все возможные ситуации в 99,9999% случаев. Погоня за последними девятками, будет сложной и очень сложной. Для этого потребуется очень мощная система машинного зрения.<br/>
<br/>
Здесь показаны изображения, которые вы можете встретить на пути к заветным знакам после запятой. Сначала у вас просто автомобили, едущие вперед, затем эти автомобили начинают выглядеть немного необычно, на них появляются велосипеды, автомобили на автомобилях. Дальше вы сталкиваетесь с действительно редкими событиями, такими как перевернутые автомобили или даже автомобили в прыжке. Мы встречаем много всякого, в данных приходящих от флота.<br/>
<br/>
И мы видим эти редкие события гораздо чаще чем наши конкуренты. Это определяет скорость, с которой мы можем заполучить данные и устранить проблемы через обучение нейросетей. Скорость прогресса пропорциональна частоте, с которой вы сталкиваетесь со сложными ситуациями в реальном мире. И мы сталкиваемся с ними чаще, чем кто-либо еще. Поэтому наш автопилот лучше других. Спасибо.<br/>
<br/>
<h2>Вопросы и ответы</h2><br/>
<br/>
<strong> Вопрос: </strong> сколько данных вы собираете в среднем с каждого автомобиля?<br/>
<br/>
<strong> Андрей: </strong> Дело не только в количестве данных, дело в разнообразии. В какой-то момент у вас уже достаточно изображений движения вперед по шоссе, сеть их понимает, больше не нужно. Поэтому стратегически мы сфокусированы на получении нужных данных. И наша инфраструктура, с довольно сложным анализом, позволяет нам получать те данные, которые нужны прямо сейчас. Это не про огромные объемы данных, это про очень хорошо отобранные данные.<br/>
<br/>
<strong> Вопрос: </strong> Мне интересно, как вы собираетесь решать проблему смены полосы движения. Всякий раз, когда я пытаюсь перестроиться в плотный поток, меня подрезают. Человеческое поведение становится иррациональным на дорогах Лос-Анджелеса. Автопилот хочет вести безопасно, а вам почти приходится делать это не безопасно.<br/>
<br/>
<strong> Андрей: </strong> Я говорил о data engine как об обучении нейронных сетей. Но мы делаем то же самое на уровне программного обеспечения. Все параметры, которые влияют на выбор, например, когда перестраиваться, насколько агрессивно. Мы также изменяем их в теневом режиме, и наблюдаем, насколько хорошо они работают и настраиваем эвристику. На самом деле проектирование подобных эвристик для общего случая, это трудноразрешимая задача. Я думаю, нам придется использовать обучение с помощью флота для принятия подобных решений. Когда люди перестраиваются в другую полосу? В каких сценариях? Когда они чувствуют, что смена полосы небезопасна? Давайте просто посмотрим на большой объем данных и обучим классификатор (machine learning classifier) различать, когда перестроение безопасно. Эти классификаторы смогут написать намного лучший код, чем люди, потому что они опираются на огромное количество данных о поведении водителей.<br/>
<br/>
<strong> Илон: </strong> Вероятно, у нас будет режим «трафик в Лос-Анджелесе». Где-то после режима «Безумный Макс». Даа, Безумному Максу пришлось бы несладко в Лос-Анджелесе.<br/>
<br/>
<strong> Андрей </strong> Придется идти на компромисс. Вы не хотите создавать небезопасные ситуации, но хотите доехать домой. И танцы которые люди исполняют при этом, это очень сложно запрограммировать. Я думаю, что правильный пусть — машинное обучение. Где мы просто смотрим на множество способов, которыми люди делают это и пытаемся имитировать их.<br/>
<br/>
<strong> Илон: </strong> Сейчас мы немного консервативны, и, по мере роста нашей уверенности, станет возможным выбирать более агрессивный режим. Пользователи смогут сами его выбирать. В агрессивных режимах, при попытке перестроиться в пробке, есть небольшая вероятность помять крыло. Без риска серьезной аварии. У вас будет выбор, согласны ли вы на ненулевой шанс помять крыло. К сожалению, это единственный способ передвижения в пробке на шоссе.<br/>
<br/>
<strong> Вопрос: </strong> Не случится ли так, на одной из тех девяток после запятой, что лидар окажется полезен? Второй вопрос, если лидары действительно бесполезны, что произойдет с теми, кто строит свои решения на них?<br/>
<br/>
<strong> Илон: </strong> Они все избавятся от лидаров, это мой прогноз, можете записать. Я должен отметить, я не ненавижу лидар так сильно, как может показаться. SpaceX Dragon использует лидар для перемещения к МКС и стыковки. SpaceX разработала свой собственный лидар с нуля для этого. Я лично возглавлял этот проект, потому что в этом сценарии лидар имеет смысл. А в машинах это чертовски глупо. Это дорого и не нужно. И, как сказал Андрей, как только вы справитесь с видео, лидар станет бесполезен. У вас будет дорогое оборудование, которое бесполезно для автомобиля.<br/>
<br/>
У нас есть радар направленный вперед. Он недорогой и полезен, особенно в условиях плохой видимости. Туман, пыль или снег, радар может видеть сквозь них. Если уж вы собираетесь использовать активную генерацию фотонов, не используйте длину волны видимого света. Потому что, обладая пассивной оптикой, вы уже позаботились обо всем в видимом спектре. Теперь лучше используйте длину волны, с хорошими проникающими свойствами, например радар. Лидар это просто активная генерация фотонов в видимом спектре. Хотите активно генерировать фотоны, делайте это вне видимого спектра. Используя 3.8 мм против 400-700 нм вы получите возможность видеть в плохих погодных условиях. Поэтому у нас есть радар. А также двенадцать ультразвуковых датчиков для ближнего окружения. Радар наиболее полезен в направлении движения, потому что именно прямо вы движетесь очень быстро.<br/>
<br/>
Мы поднимали вопрос сенсоров много раз. Достаточно ли их? Есть ли у нас есть все что нужно? Нужно добавить что-то еще? Хммм. Достаточно.<br/>
<br/>
<strong> Вопрос: </strong> Похоже, что автомобили производят какие-то вычисления, чтобы определить, какую информацию вам отправить. Это делается в режиме реального времени или на основе сохраненной информации?<br/>
<br/>
<strong> Андрей: </strong> Вычисления производятся в режиме реального времени в самих автомобилях. Мы передаем условия, которые нас интересуют, а автомобили делают все нужные вычисления. Если бы они этого не делали, нам пришлось бы передавать все данные подряд и обрабатывать их в нашем бэк-энде. Мы не хотим этого делать.<br/>
<br/>
<strong> Илон: </strong> У нас есть четыреста двадцать пять тысяч автомобилей с HW2.0+. Это означает, что в них есть восемь камер, радар, ультразвуковые датчики и по крайней мере компьютер nVidia. Его достаточно, чтобы вычислить, какая информация важна, а какая нет. Они сжимают важную информацию и отправляют ее в сеть для обучения. Это огромная степень сжатия данных из реального мира.<br/>
<br/>
<strong> Вопрос: </strong> У вас есть эта сеть из сотен тысяч компьютеров, которая напоминает мощный распределенный ЦОД. Видите ли вы её применение для целей, отличных от автопилота?<br/>
<br/>
<strong> Илон: </strong> Я полагаю, это можно было бы использовать для чего-то еще. Пока мы сосредоточены на автопилоте. Как только доведем его до нужного уровня, сможем подумать о других применениях. К тому времени это будут миллионы или десятки миллионов машин с HW3.0 или FSDC.<br/>
<br/>
<strong> Вопрос: </strong> Вычисление дорожного трафика?<br/>
<br/>
<strong> Илон: </strong> Да, может быть. это может быть что-то вроде AWS (Amazon Web Services).<br/>
<br/>
<strong> Вопрос: </strong> Я водитель Model 3 в Миннесоте, где много снега. Камера и радар не могут видеть дорожную разметку сквозь снег. Как вы собираетесь решать подобную проблему? Будете использовать GPS высокой точности?<br/>
<br/>
<strong> Андрей: </strong> Уже сегодня автопилот довольно неплохо ведется себя на заснеженной дороге. Даже когда разметка скрыта, или истертая, или покрыта водой в сильный дождь, все равно автопилот ведет себя относительно хорошо. Мы пока еще специально не обрабатывали заснеженную дорогу с помощью нашего data engine. Но я уверен, что эта задача поддается решению. Потому что на многих изображениях заснеженной дороги, если вы спросите человека, где должна быть разметка, он покажет её вам. Люди соглашаются в том где провести линии разметки. И пока люди могут прийти к согласию и разметить ваши данные, нейронная сеть сможет этому научится и будет хорошо работать. Вопрос только в том есть ли достаточно информации в исходном сигнале. Достаточно для человека аннотатора? Если ответ да, то нейронная сеть справится с этим просто отлично.<br/>
<br/>
<strong> Илон: </strong> В исходном сигнале есть несколько важных источников информации. Так разметка, это лишь один из них. Самый важный источник это проезжая часть (drive space). Где можно ехать, а где нельзя. Гораздо важнее разметки. Распознавание проезжей части работает очень хорошо. Я думаю, особенно после предстоящей зимы, будет работать просто невероятно. Мы будем удивляться, как это может настолько хорошо работать. Это просто безумие.<br/>
<br/>
<strong> Андрей: </strong> Дело даже не в возможности людей нанести разметку. До тех пор, пока вы, человек, можете преодолеть этот участок дороги. Флот будет учиться у вас. Мы знаем как вы проехали здесь. И вы, очевидно, использовали зрение для этого. Вы не видели разметку, но использовали геометрию всей сцены. Вы видите, как дорога изгибается, как другие машины расположены вокруг вас. Нейронная сеть автоматически выделит все эти шаблоны, нужно только получить достаточно данных о том, как люди преодолевают подобные ситуации.<br/>
<br/>
<strong> Илон: </strong> Очень важно не привязываться жестко к GPS. Ошибка GPS может быть весьма существенной. И реальная дорожная ситуация может быть непредсказуемой. Это может быть ремонт дороги или объезд. Если автомобиль слишком сильно полагается на GPS, это плохая ситуация. Вы напрашиваетесь на неприятности. GPS хорошо использовать только как подсказку.<br/>
<br/>
<strong> Вопрос: </strong> Некоторые из ваших конкурентов рассказывают о том, как они используют карты высокого разрешения (high definition maps) для улучшения восприятия и планирования пути. Используете ли вы что-то подобное в своей системе, видите ли вы в этом какую-то пользу? Есть ли области, где вы хотели бы иметь больше данных, не от флота, а что-то наподобие карт?<br/>
<br/>
<strong> Илон: </strong> Я думаю, карты высокого разрешения — это очень плохая затея. Система становится чрезвычайно неустойчивой. Не способной адаптироваться к изменениям, если вы привязаны к GPS и картам высокого разрешения и не отдаете приоритет зрению. Зрение это та вещь, которая должна делать все. Смотрите, разметка это просто ориентир, а не самая важная вещь. Мы пробовали использовать карты разметки и быстро поняли, что это большая ошибка. Мы полностью отказались от них.<br/>
<br/>
<strong> Вопрос: </strong> Понимание того, где находятся объекты и как движутся машины это все очень полезно. Но как быть с переговорным аспектом? Во время парковки, на кольцевых развязках и в других ситуациях, где вы взаимодействуете с другими автомобилями, и которыми управляют люди. Это скорее искусство, чем наука.<br/>
<br/>
<strong> Илон: </strong> Это работает довольно хорошо. Если смотреть на ситуации с перестроениями и т.п., автопилот нормально справляется.<br/>
<br/>
<strong> Андрей: </strong> Сейчас мы используем много машинного обучения для создания представления о реальном мире. Поверх этого у нас есть планировщик и контроллер и множество эвристик о том, как ехать, как учитывать другие автомобили и так далее. И также как в распознавании образов здесь есть множество нестандартных случаев, это как игра ястребы и голуби, в которую вы играете с другими людьми. Мы уверены, что в конечном итоге мы используем обучение с помощью флота для решения этой задачи. Ручное написание эвристик быстро упирается в плато.<br/>
<br/>
<strong> Вопрос: </strong> у вас есть режим автоколонны (platooning)? Система способна на это?<br/>
<br/>
<strong> Андрей: </strong> Я абсолютно уверен, что мы могли бы сделать такой режим. Но опять, если вы просто обучаете сеть подражать людям. Люди пристраиваются и едут за автомобилем впереди и сеть запоминает это поведение. В этом есть своего рода волшебство, все происходит само собой. Разные проблемы сводятся к одной, просто соберите набор данных и используете его для обучения нейронной сети.<br/>
<br/>
<strong> Илон: </strong> Три шага к автономному вождению. Первый — просто реализовать эту функциональность. Второй — довести её до такой степени, когда человеку в машине вообще не нужно обращать внимание на дорогу. И третий — показать уровень надежности, который убедит регуляторов. Это три уровня. Мы ожидаем в этом году достигнуть первого уровня. И мы рассчитываем, где-то во втором квартале следующего года достигнуть уровня уверенности, когда человеку больше не нужно держать руки на руле и смотреть на дорогу. После этого мы ожидаем получить одобрение регулирующих органов, по крайней мере, в некоторых юрисдикциях к концу следующего года. Это мои ожидания.<br/>
<br/>
Вероятно, для грузовых автомобилей, режим автоколонны будет одобрен регулирующими органами раньше всего остального. Возможно, для дальних поездок вы сможете использовать одного водителя в головной машине, и 4 грузовика Semi позади него в режиме автоколонны.<br/>
<br/>
<strong> Вопрос: </strong> Я очень впечатлён улучшением автопилота. На прошлой неделе я ехал в правой полосе автомагистрали, и там был въезд. Моя Model 3 смогла обнаружить две машины въезжающие на магистраль и сбавила скорость так, что одна машина спокойно встроилась передо мной, а другая позади меня. Я тогда подумал, черт побери, это безумие, я не знал, что моя Model 3 способна на такое.<br/>
<br/>
Но на той же неделе я снова ехал в правой полосе, и там было сужение, моя правая полоса сливалась с левой. И моя Model 3 не смогла правильно среагировать, мне пришлось вмешаться. Можете рассказать, как Tesla может решить эту проблему?<br/>
<br/>
<strong> Андрей: </strong> Я рассказывал про инфраструктуру сбора данных. Если вы вмешались, то, скорее всего, мы получили этот клип. Он попал в статистку, например, с какой вероятностью мы корректно вливаемся в поток. Мы смотрим на эти цифры, смотрим на клипы, и мы видим что не так. И мы пытаемся исправить поведение, чтобы добиться улучшения в сравнении с контрольными показателями.<br/>
<br/>
<strong> Илон: </strong> Хорошо, у нас есть еще одна презентация, посвященная программному обеспечению. У нас была презентация про оборудование с Питом, потом нейронные сети с Андреем, а теперь следует программное обеспечение со Стюартом.<br/>
…</div></div> <!----> <!----></div> <div class="tm-article-presenter__meta"><div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Теги:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5BTesla%5D" class="tm-tags-list__link">Tesla</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%B0%D0%B2%D1%82%D0%BE%D0%BF%D0%B8%D0%BB%D0%BE%D1%82%5D" class="tm-tags-list__link">автопилот</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%B8%D1%81%D0%BA%D1%83%D1%81%D1%81%D1%82%D0%B2%D0%B5%D0%BD%D0%BD%D1%8B%D0%B9%20%D0%B8%D0%BD%D1%82%D0%B5%D0%BB%D0%BB%D0%B5%D0%BA%D1%82%5D" class="tm-tags-list__link">искусственный интеллект</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%BC%D0%B0%D1%88%D0%B8%D0%BD%D0%BD%D0%BE%D0%B5%20%D0%BE%D0%B1%D1%83%D1%87%D0%B5%D0%BD%D0%B8%D0%B5%5D" class="tm-tags-list__link">машинное обучение</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%BD%D0%B5%D0%B9%D1%80%D0%BE%D0%BD%D0%BD%D1%8B%D0%B5%20%D1%81%D0%B5%D1%82%D0%B8%5D" class="tm-tags-list__link">нейронные сети</a></li></ul></div> <div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Хабы:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/hub/bigdata/" class="tm-hubs-list__link">
    Big Data
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/machine_learning/" class="tm-hubs-list__link">
    Машинное обучение
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/artificial_intelligence/" class="tm-hubs-list__link">
    Искусственный интеллект
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/transport/" class="tm-hubs-list__link">
    Транспорт
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/futurenow/" class="tm-hubs-list__link">
    Будущее здесь
  </a></li></ul></div></div></article></div> <!----></div> <div class="tm-article-sticky-panel"><div class="tm-data-icons tm-article-sticky-panel__icons"><div class="tm-article-rating tm-data-icons__item"><div class="tm-votes-meter tm-article-rating__votes-switcher"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_medium"><title>Всего голосов 67: ↑64 и ↓3</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-rating"></use></svg> <span title="Всего голосов 67: ↑64 и ↓3" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_medium">+61</span></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">28K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    95
  </span></button> <!----> <div title="Поделиться" class="tm-sharing tm-data-icons__item"><button type="button" class="tm-sharing__button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> </div></div> <!----> <!----> <div class="tm-article-presenter__footer"><div class="tm-article-blocks"><!----> <section class="tm-block tm-block_spacing-bottom"><!----> <div class="tm-block__body tm-block__body_variant-balanced"><div class="tm-article-author"> <div class="tm-user-card tm-article-author__user-card tm-user-card_variant-article"><div class="tm-user-card__info-container"><div class="tm-user-card__header"><div class="tm-user-card__header-data"><a href="/ru/users/androude/" class="tm-user-card__userpic tm-user-card__userpic_size-40"><div class="tm-entity-image"><img alt="" src="//habrastorage.org/getpro/habr/avatars/f2f/db4/6b0/f2fdb46b0d5d6ff9e7cac5129ed7e651.jpg" class="tm-entity-image__pic"></div></a> <div class="tm-user-card__meta"><div title=" 41 голос " class="tm-karma tm-user-card__karma"><div class="tm-karma__votes tm-karma__votes_positive">
    23
  </div> <div class="tm-karma__text">
    Карма
  </div></div> <div title="Рейтинг пользователя" class="tm-rating tm-user-card__rating"><div class="tm-rating__header"> <div class="tm-rating__counter">0</div></div> <div class="tm-rating__text">
    Рейтинг
  </div></div></div></div></div> <div class="tm-user-card__info tm-user-card__info_variant-article"><div class="tm-user-card__title tm-user-card__title_variant-article"><span class="tm-user-card__name tm-user-card__name_variant-article">Andrei Odue</span> <a href="/ru/users/androude/" class="tm-user-card__nickname tm-user-card__nickname_variant-article">
          @androude
        </a> <!----></div> <p class="tm-user-card__short-info tm-user-card__short-info_variant-article">C/C++/automotive-infotainment</p></div></div> <div class="tm-user-card__buttons tm-user-card__buttons_variant-article"><!----> <!----> <!----> <!----> <!----></div></div> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----></section> <div class="tm-article-blocks__comments"><div class="tm-article-page-comments"><div class="tm-article-comments-counter-link tm-article-comments-counter-button"><a href="/ru/post/450796/comments/" class="tm-article-comments-counter-link__link tm-article-comments-counter-link__link_button-style"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon tm-article-comments-counter-link__icon_contrasted"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value tm-article-comments-counter-link__value_contrasted">
       Комментарии 67 
    </span></a> <!----></div></div></div> <div class="tm-ad-banner__container tm-page-article__banner"><!----> <div id="articleBottomBanner" class="tm-ad-banner"></div></div> <!----> <!----> <!----> <!----> </div></div></div></div></div> <div class="tm-page__sidebar"><div class="tm-layout-sidebar"><div class="tm-layout-sidebar__ads tm-layout-sidebar__ads_initial"><div class="tm-ad-banner__container tm-layout-sidebar__banner"><!----> <div id="sidebarBanner" class="tm-ad-banner"></div></div></div> <div class="tm-sexy-sidebar tm-sexy-sidebar_initial" style="margin-top:0px;"><!----> <!----></div></div></div></div></div></div></main> <!----></div> <div class="tm-footer-menu"><div class="tm-page-width"><div class="tm-footer-menu__container"><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Ваш аккаунт
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr/?back=/ru/post/450796/&amp;hl=ru" rel="nofollow" target="_self">
                Войти
              </a></li><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr-register/?back=/ru/post/450796/&amp;hl=ru" rel="nofollow" target="_self">
                Регистрация
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Разделы
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/" class="footer-menu__item-link router-link-active">
                Публикации
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/news/" class="footer-menu__item-link">
                Новости
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/hubs/" class="footer-menu__item-link">
                Хабы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/companies/" class="footer-menu__item-link">
                Компании
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/users/" class="footer-menu__item-link">
                Авторы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/sandbox/" class="footer-menu__item-link">
                Песочница
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Информация
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/docs/help/" class="footer-menu__item-link">
                Устройство сайта
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/authors/codex/" class="footer-menu__item-link">
                Для авторов
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/companies/corpblogs/" class="footer-menu__item-link">
                Для компаний
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/docs/transparency/" class="footer-menu__item-link">
                Документы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/agreement" target="_blank">
                Соглашение
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/confidential/" target="_blank">
                Конфиденциальность
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Услуги
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQLwRfQmXibiUlWaRg-BAc38s7oM3lJiaPju7qmdJsp8ysIvZ_G-Npem0njJLMozE2bPHMpDqiI5hhy/pub?start=false&amp;loop=false&amp;delayms=60000&amp;slide=id.g91a03369cd_4_297" target="_blank">
                Реклама
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habrastorage.org/storage/stuff/habr/service_price.pdf" target="_blank">
                Тарифы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQJJds8-Di7BQSP_guHxICN7woVYoN5NP_22ra-BIo4bqnTT9FR6fB-Ku2P0AoRpX0Ds-LRkDeAoD8F/pub?start=false&amp;loop=false&amp;delayms=60000" target="_blank">
                Контент
              </a></li><li class="tm-footer-menu__list-item"><a href="https://tmtm.timepad.ru/" target="_blank">
                Семинары
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/megaprojects/" class="footer-menu__item-link">
                Мегапроекты
              </a></li></ul></div></div></div></div></div> <div class="tm-footer"><div class="tm-page-width"><div class="tm-footer__container"><!----> <div class="tm-footer__social"><a href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Facebook</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-facebook"></use></svg></a><a href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Twitter</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-twitter"></use></svg></a><a href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>VK</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-vkontakte"></use></svg></a><a href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Telegram</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-telegram"></use></svg></a><a href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Youtube</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-youtube"></use></svg></a><a href="https://zen.yandex.ru/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Яндекс Дзен</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-zen"></use></svg></a></div> <DIV class="v-portal" style="display:none;"></DIV> <button class="tm-footer__link"><!---->
        Настройка языка
      </button> <a href="/ru/about" class="tm-footer__link">
        О сайте
      </a> <a href="/ru/feedback/" class="tm-footer__link">
        Техническая поддержка
      </a> <!----> <a href="/berserk-mode-nope" class="tm-footer__link">
        Вернуться на старую версию
      </a> <div class="tm-footer-copyright"><span class="tm-copyright"><span class="tm-copyright__years">© 2006–2021 </span> <span class="tm-copyright__name">«<a href="https://company.habr.com/" rel="noopener" target="_blank" class="tm-copyright__link">Habr</a>»</span></span></div></div></div></div> <!----> <!----></div> <div class="vue-portal-target"></div></div>
<script>window.__INITIAL_STATE__={"adblock":{"hasAcceptableAdsFilter":false,"hasAdblock":false},"articlesList":{"articlesList":{"450796":{"id":"450796","timePublished":"2019-05-13T06:36:14+00:00","isCorporative":false,"lang":"ru","titleHtml":"Как Tesla обучает автопилот","leadData":{"textHtml":"\u003Cem\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fvc\u002Fch\u002Flx\u002Fvcchlxqf5blytupr3nsndhmmgay.png\"\u003E\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nРасшифровка 2-й части Tesla Autonomy Investor Day. Цикл обучения автопилота, инфраструктура сбора данных, автоматическая разметка данных, подражание водителям-людям, определение расстояния по видео, sensor-supervision и многое другое.\u003C\u002Fem\u003E\u003Cbr\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше →","image":null},"editorVersion":"1.0","postType":"article","postLabels":[{"type":"translation","data":{"originalAuthorName":"Tesla","originalUrl":"https:\u002F\u002Fyoutu.be\u002FUcp0TTmvqOE"}}],"author":{"scoreStats":{"score":23,"votesCount":41},"rating":0,"relatedData":null,"contacts":[],"authorContacts":[],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null},"id":"593119","alias":"androude","fullname":"Andrei Odue","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Ff2f\u002Fdb4\u002F6b0\u002Ff2fdb46b0d5d6ff9e7cac5129ed7e651.jpg","speciality":"C\u002FC++\u002Fautomotive-infotainment"},"statistics":{"commentsCount":67,"favoritesCount":95,"readingCount":27871,"score":61,"votesCount":67},"hubs":[{"relatedData":null,"id":"17795","alias":"bigdata","type":"collective","title":"Big Data","titleHtml":"Big Data","isProfiled":true},{"relatedData":null,"id":"19439","alias":"machine_learning","type":"collective","title":"Машинное обучение","titleHtml":"Машинное обучение","isProfiled":true},{"relatedData":null,"id":"21922","alias":"artificial_intelligence","type":"collective","title":"Искусственный интеллект","titleHtml":"Искусственный интеллект","isProfiled":false},{"relatedData":null,"id":"22004","alias":"transport","type":"collective","title":"Транспорт","titleHtml":"Транспорт","isProfiled":false},{"relatedData":null,"id":"22014","alias":"futurenow","type":"collective","title":"Будущее здесь","titleHtml":"Будущее здесь","isProfiled":false}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"textHtml":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003E\u003Cem\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fvc\u002Fch\u002Flx\u002Fvcchlxqf5blytupr3nsndhmmgay.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nРасшифровка 2-й части Tesla Autonomy Investor Day. Цикл обучения автопилота, инфраструктура сбора данных, автоматическая разметка данных, подражание водителям-людям, определение расстояния по видео, sensor-supervision и многое другое.\u003C\u002Fem\u003E\u003Cbr\u002F\u003E\r\n\u003Ca name=\"habracut\"\u003E\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Cem\u003E\u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fpost\u002F450500\u002F\"\u003EПервая часть — разработка Full Self-Driving Computer (FSDC)\u003C\u002Fa\u003E.\u003C\u002Fem\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E Хост: \u003C\u002Fstrong\u003E FSDC может работать с очень сложными нейронными сетями для обработки изображений. Пора поговорить о том, как мы получаем изображения и как мы их анализируем. У нас здесь старший директор AI в Tesla — Андрей Карпаты, который объяснит вам все это.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E Андрей: \u003C\u002Fstrong\u003E Я занимаюсь обучением нейронных сетей примерно десять лет, и вот уже 5-6 лет для промышленного применения. В том числе в таких известных учреждениях как Стэнфорд, Open AI и Google. Это множество нейронных сетей не только для обработки изображений, но и естественного языка. Я проектировал архитектуры, которые объединяют эти две модальности для своей докторской диссертации.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ Стэнфорде я вел курс по деконволюционным нейросетям. Я был основным преподавателем и разработал всю учебную программу к нему. Вначале у меня было около 150 студентов, в течение следующих двух или трех лет число студентов выросло до 700. Это очень популярный курс, один из самых больших и успешных курсов в Стэнфорде прямо сейчас.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E Илон: \u003C\u002Fstrong\u003E Андрей действительно один из лучших специалистов по машинному зрению в мире. Возможно, лучший.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E Андрей: \u003C\u002Fstrong\u003E Спасибо. Привет всем. Пит рассказал вам о чипе, который мы разработали специально для нейросетей в автомобиле. Моя команда отвечает за обучение этих нейросетей. Это включает в себя сбор данных, обучение, и частично, развертывание.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЧто делают нейронные сети в автомобиле. В машине восемь камер, которые снимают видео. Нейронные сети смотрят эти видео, обрабатывают их и делают прогнозы относительно того, что они видят. Нас интересует дорожная разметка, участники движения, прочие объекты и расстояния до них, проезжая часть, светофоры, дорожные знаки и так далее.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Flu\u002F-b\u002F-u\u002Flu-b-ufhozioprg2nvebadsk4zs.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nМое выступление можно разделить на три части. Сначала я кратко ознакомлю вас с нейронными сетями и с тем, как они работают и как их обучают. Это необходимо сделать, чтобы во второй части было понятно, почему так важно что у нас есть огромный парк автомобилей Tesla (fleet). Почему это является ключевым фактором, позволяющим обучать нейронные сети, которые эффективно работают на дорогах. В третьей части я расскажу о машинном зрении, лидаре и о том, как оценивать расстояние используя только видео.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch2\u003EКак работают нейронные сети\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\n\u003Cem\u003E(Тут мало нового, можно пропустить и перейти к следующему заголовку)\u003C\u002Fem\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nОсновная задача, которую сети решают в автомобиле это распознавание образов. Для нас, людей, это очень простая задача. Вы смотрите на изображения и видите виолончель, лодку, игуану или ножницы. Очень легко и просто для вас, но не для компьютера. Причина в том, что эти изображения для компьютера являются просто массивом пикселей, где каждый пиксель это значение яркости в этой точке. Вместо того, чтобы просто видеть изображение, компьютер получает миллион чисел в массиве.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E Илон: \u003C\u002Fstrong\u003E Матрица, если хотите. Реально матрица.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fx7\u002Fsy\u002Fzq\u002Fx7syzqa6mvf_64j6nsk8dovzyww.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E Андрей: \u003C\u002Fstrong\u003E Да. Мы должны перейти от этой сетки пикселей и значений яркости к высокоуровневым понятиям, таким как игуана и так далее. Как вы можете себе представить, это изображение игуаны имеет определенный шаблон яркости. Но игуаны могут быть изображены по-разному, в разных позах, в разных условиях освещения, на разном фоне. Вы можете найти множество разных изображений игуаны и мы должны распознать её в любых условиях.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПричина, по которой вы и я легко с этим справляемся — у нас внутри огромная нейронная сеть, которая обрабатывает изображения. Свет попадает на сетчатку и направляется в заднюю часть вашего мозга к зрительной коре. Кора головного мозга состоит из множества нейронов, которые связаны друг с другом и выполняют распознавание образов.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПоследние лет пять, современные подходы к обработке изображений с использованием компьютеров также начали использовать нейронные сети, но в данном случае — искусственные нейронные сети. Искусственные нейронные сети представляют собой грубое математическое приближение зрительной коры. Здесь тоже есть нейроны, они связаны друг с другом. Типичная нейронная сеть включает десятки или сотни миллионов нейронов, и каждый нейрон имеет тысячи связей.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nМы можем взять нейронную сеть и показать ей изображения, например нашу игуану, и сеть сделает прогноз (prediction), что она видит. Сначала нейронные сети инициализируются совершенно случайно, все веса связей между нейронами — случайные числа. Поэтому прогноз сети тоже будет случайным. Может оказаться, что сеть думает что это, вероятно, лодка. Во время тренировки мы знаем и отмечаем, что на изображении игуана. Мы попросту говорим, что хотели бы, чтобы вероятность игуаны для этого изображения увеличилась, а вероятность всего остального уменьшилась. Затем используется математический процесс, называемый методом обратного распространения ошибки. Стохастический градиентный спуск, который позволяет нам распространять сигнал по связям и обновлять их веса. Обновим вес каждого из этих соединений совсем немного, и как только обновление будет завершено, вероятность игуаны для этого изображения немного возрастет, а вероятность других ответов снизится.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nКонечно, мы делаем это не с одним единственным изображением. У нас есть большой набор размеченных данных. Обычно это миллионы изображений, тысячи меток или около того. Процесс обучения повторяется снова и снова. Вы показываете компьютеру изображение, он сообщает вам свое мнение, затем вы говорите правильный ответ, и сеть немного настраивается. Вы повторяете это миллионы раз, иногда показываете одно и то же изображение сотни раз. Обучение обычно занимает несколько часов или несколько дней.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nТеперь кое-что контр-интуитивное о работе нейросетей. Им нужно действительно много примеров. Это не просто уместить в голове, но они реально начинают с нуля, они ничего не знают. Вот пример — милая собачка, и вы, вероятно, не знаете ее породы. Это японский спаниель. Мы с вами смотрим на эту картинку и мы видим японского спаниеля. Мы можем сказать: «ОК я понял, теперь я знаю, как выглядит японский спаниель». Если я покажу вам еще несколько изображений других собак, вы сможете найти среди них других японских спаниелей. Вам понадобился всего один пример, но компьютеры так не могут. Им нужна куча данных о японских спаниелях, тысячи примеров, в разных позах, разных условиях освещения, на разном фоне и т.д. Вам нужно показать компьютеру, как выглядит японский спаниель с разных точек зрения. И ему действительно нужны все эти данные, противном случае компьютер не сможет выучить нужный шаблон.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch2\u003EРазметка изображений для автопилота\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\nТак как же это все относится к автономному вождению. Нас не очень заботят породы собак. Может быть, будут заботить в будущем. Но сейчас нас интересует дорожная разметка, объекты на дороге, где они находятся, куда мы можем ехать и так далее. У нас теперь нет просто меток вроде «игуана», но у нас есть изображения дороги, и нас интересует, например, дорожная разметка. Человек смотрит на изображение и с помощью мыши отмечает её.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Feq\u002Fwa\u002Fwo\u002Feqwawo_3ky3vffm_hkkheyrhmlq.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nУ нас есть возможность обратится к автомобилям Tesla и попросить еще больше фотографий. Если запросить случайные фото, вы получите изображения где, как правило, машина просто едет по шоссе. Это будет случайный набор данных и мы разметим его.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЕсли вы будете размечать только случайные наборы, ваша сеть выучит простую, часто встречающуюся дорожную ситуацию и будет работать хорошо только в ней. Когда вы покажете ей немного другой пример, скажем, изображение поворота дороги в жилом районе. Ваша сеть может дать неправильный результат. Она скажет «хорошо, я видела много раз, дорога идет прямо». \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002F_9\u002F4u\u002Fx2\u002F_94ux28ucicihvbggphmoqc5i0y.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nКонечно, это совсем неверно. Но мы не можем винить нейронную сеть. Она не знает, имеет ли значение дерево слева, автомобиль справа, или те здания на заднем плане. Сеть не знает ничего об этом. Мы с вами знаем, значение имеет, линия разметки и тот факт, что она немного сворачивает в сторону. Сеть должна учесть это, но нет механизма, с помощью которого мы можем просто сказать нейронной сети, что вот эти штрихи дорожной разметки действительно имеют значение. Единственный инструмент в наших руках это размеченные данные.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fe5\u002Few\u002Fd3\u002Fe5ewd3fhqw_ebegpk0heamyjafk.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nМы берем изображения, на которых сеть ошибается, и размечаем их правильно. В данном случае мы отметим поворачивающую разметку. Затем нужно передать множество подобных изображений в нейронную сеть. И со временем она накопит знания и научится понимать этот шаблон, понимать, что вот эта часть изображения не играет роли, а вот эта разметка очень даже важна. Сеть научится правильно находить полосу движения.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВажен не только размер набора обучающих данных. Нам нужны не просто миллионы изображений. Нужно проделать немалую работу, чтобы покрыть пространство ситуаций, которые автомобиль может встретить на дорогах. Нужно научить компьютер работать ночью и в дождь. Дорога может отражать свет как зеркало, освещенность может варьироваться в больших пределах, изображения будут выглядеть очень по-разному.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fk4\u002Fog\u002F1f\u002Fk4og1fzgiwwt6jy_rwcefm3fndm.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nМы должны научить компьютер как обращаться с тенями, развилками, с крупными объектами, занимающими большую часть изображения. Как работать с туннелями или в зоне ремонта дороги. И во всех этих случаях нет прямого механизма сообщить сети, что делать. У нас есть только огромный набор данных. Мы можем взять изображения, разметить, и обучать сеть пока она не начнет понимать их структуру.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nБольшие и разнообразные наборы данных помогают сетям работать очень хорошо. Это не наше открытие. Эксперименты и исследования Google, Facebook, Baidu, Deepmind от Alphabet. Все показывают схожие результаты — нейронные сети действительно любят данные, любят количество и разнообразие. Добавляете больше данных и точность нейронных сетей растет.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch2\u003EВам придется разработать автопилот, чтобы симулировать поведение машин в симуляции\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\nРяд специалистов отмечают, что мы могли бы использовать симуляцию, чтобы заполучить необходимые данные в нужном масштабе. В Tesla мы не раз задавались этим вопросом. У нас есть собственный симулятор. Мы широко используем симуляцию для разработки и оценки программного обеспечения. Мы использовали её и для обучения довольно успешно. Но в итоге, когда дело доходит до обучающих данных для нейронных сетей, ничто не заменит реальных данных. Симуляции имеют проблемы с моделированием внешнего вида, физики и поведения участников.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fob\u002Fhe\u002Fxw\u002Fobhexwtzhagxn7n_z0ildcfzyl8.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nРеальный мир подкидывает нам кучу неожиданных ситуаций. Сложные условия со снегом, деревьями, ветром. Различные визуальные артефакты, которые трудно смоделировать. Зоны ремонта дороги, кусты, болтающиеся на ветру полиэтиленовые пакеты. Там может быть много людей, взрослые, дети и животные вперемешку. Моделирование поведения и взаимодействия всего этого оказывается совершенно неразрешимой задачей.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002F2k\u002F3r\u002F7a\u002F2k3r7as1159puh5ad4bf3fwrltc.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nРечь идет не о передвижении одного пешехода. Речь идет о том, как пешеходы реагируют друг на друга, и как машины реагируют друг на друга, как они реагируют на вас. Все это очень сложно симулировать. Вам нужно сначала разработать автопилот, только чтобы симулировать поведение автомобилей в симуляции.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЭто правда сложно. Это могут быть собаки, экзотические животные, а иногда это даже не то, что вы не можете симулировать, это то, что просто никогда не придет к вам в голову. Я не знал, что грузовик может перевозить грузовик, который везет грузовик, который везет еще один грузовик. Но в реальном мире происходит и это и много других вещей, которые трудно придумать. Разнообразие, которое я вижу в данных, поступающих от автомобилей, просто безумно по отношению к тому, что мы имеем в симуляторе. Хотя у нас хороший симулятор.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E Илон: \u003C\u002Fstrong\u003E Симуляция — это, как если бы вы сами себе придумывали домашнее задание. Если вы знаете что будете симулировать, Окей, что вы конечно разберетесь с этим. Но как сказал Андрей — ты не знаешь, чего ты не знаешь. Мир очень странный, в нем миллионы особых случаев. Если кто-то создаст симуляцию вождения, которая будет точно воспроизводить реальность, это само по себе станет монументальным достижением человечества. Но никто не может этого сделать. Просто нет способа.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch2\u003EФлот — ключевой источник данных для обучения\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002F8u\u002Fkj\u002Fh7\u002F8ukjh7k3qw7-sv469pyhnnbwhi0.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E Андрей: \u003C\u002Fstrong\u003E Чтобы нейронные сети работали хорошо вам нужен большой, разнообразный и реальный набор данных. И если он у вас есть, вы сможете обучить свою нейронную сеть и она будет работать очень хорошо. Так почему Tesla такая особенная в этом отношении? Ответ конечно же — флот (fleet, автопарк Tesla). Мы можем собирать данные со всех автомобилей Tesla и использовать их для обучения.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nДавайте рассмотрим конкретный пример улучшения работы детектора объектов. Это даст вам представление о том, как мы обучаем нейронные сети, как мы их применяем, и как они становятся лучше с течением времени.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nОбнаружение объектов одна из важных для нас задач. Нам нужно выделить габариты автомобилей и других объектов, чтобы отслеживать их и понимать как они могут перемещаться. Мы можем попросить людей разметить изображения. Люди скажут: «вот машины, вот велосипеды» и так далее. И мы можем обучить нейронную сеть на этих данных. Но в некоторых случаях сеть будет делать неправильные прогнозы.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002F7h\u002Fst\u002Fqk\u002F7hstqk7ygew-tfoo_ibersaw86s.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНапример, если мы наткнемся на ​​машину к которой сзади прикреплен велосипед, то наша нейронная сеть обнаружит 2 объекта — автомобиль и велосипед. Именно так она работала, когда я только пришел. И по-своему это правильно, потому что оба этих объекта действительно здесь присутствуют. Но планировщику автопилота нет никакого дела до того факта, что этот велосипед — отдельный объект, который перемещается вместе с автомобилем. Правда в том, что этот велосипед жестко прикреплен к автомобилю. С точки зрения объектов на дороге это один объект — один автомобиль. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fms\u002Fd0\u002Foi\u002Fmsd0oiytsgapqj3dczs6s_hpocc.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nТеперь мы хотели бы разметить множество подобных объектов как «один автомобиль». Наша команда использует следующий подход. Мы берем это изображение или несколько изображений, на которых присутствует такая модель. И у нас есть механизм машинного обучения, с помощью которого мы можем попросить флот предоставить нам примеры, которые выглядят так же. И флот присылает изображения в ответ.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fyt\u002Fxh\u002Fuj\u002Fytxhujmzul8r8dpqwido3fr_rns.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВот пример шести полученных изображений. Все они содержат велосипеды прикрепленные к автомобилям. Мы разметим их правильно и наш детектор станет работать лучше. Сеть начнет понимать, когда велосипед прикреплен к автомобилю, и что это один объект. Вы можете обучить сеть этому при условии, что у вас есть достаточное количество примеров. И именно так мы решаем подобные задачи.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЯ довольно много говорю о получении данных с автомобилей Tesla. И я хочу сразу сказать, что мы разрабатывали эту систему с самого начала с учетом конфиденциальности. Все данные, которые мы используем для обучения, анонимизированы.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nФлот присылает нам не только велосипеды на автомобилях. Мы постоянно ищем множество разных моделей. Например, мы ищем лодки — флот присылает изображения лодок на дорогах. Мы хотим изображения зон ремонта дороги, и флот присылает нам множество таких изображений со всего мира. Или например, мусор на дороге, это тоже очень важно. Флот присылает нам изображением шин, конусов, пластиковых пакетов и тому подобного на дороге.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Faa\u002Fne\u002F2x\u002Faane2xostifrgw-xjzwcklq-zbm.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nМы можем заполучить достаточно изображений, правильно их разметить, и нейронная сеть научится работать с ними в реальном мире. Нам нужно, чтобы нейронная сеть понимала, что происходит и корректно реагировала.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch2\u003EНеуверенность нейросети запускает сбор данных\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\nПроцедура, которую мы повторяем снова и снова для обучения нейронной сети, выглядит следующим образом. Мы начали со случайного набора изображений полученных от флота. Мы размечаем изображения, обучаем нейронную сеть и загружаем её в автомобили. У нас есть механизмы, с помощью которых мы обнаруживаем неточности в работе автопилота. Если мы видим, что нейронная сеть не уверена или есть вмешательство водителя или другие события, происходит автоматическая отправка данных, на которых это произошло. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fzl\u002Fze\u002Faz\u002Fzlzeazzv1wrzsxbntqq5wtw0-50.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНапример, плохо распознается разметка в туннелях. Мы замечаем, что в туннелях есть проблема. Соответствующие изображения попадают в наши юнит-тесты, чтобы проблема не могла повториться позднее. Теперь, чтобы исправить проблему, нам нужно много обучающих примеров. Мы просим флот отправить нам больше изображений туннелей, правильно их размечаем, добавляем в обучающую выборку и переобучаем сеть, а затем загружаем в автомобили. Этот цикл повторяется снова и снова. Мы называем этот итеративный процесс data engine (машина данных? движок данных?). Включаем сеть в теневом режиме (shadow mode), обнаруживаем неточности, запрашиваем больше данных, включаем их в обучающую выборку. Мы делаем это для всех видов предсказаний наших нейронных сетей.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch2\u003EАвтоматическая разметка данных\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\nЯ много говорил о ручной разметке изображений. Это затратный процесс, и по времени и финансово. Он может стоить слишком дорого. Я хочу рассказать о том, как здесь можно использовать флот. Ручная разметка это узкое место. Мы хотим просто передавать данные и размечать их автоматически. И для этого есть несколько механизмов.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nКак пример, один из наших недавних проектов — обнаружение перестроений. Вы едете по шоссе, кто-то едет слева или справа, и он перестраивается в вашу полосу.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fjk\u002F-g\u002Fy4\u002Fjk-gy4iyujnhhwpmzb0lcwpggci.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВот видео, где автопилот обнаруживает перестроение. Конечно, мы хотели бы обнаружить его как можно раньше. Подход к решению этой проблемы заключается в том, что мы не пишем код вроде: включен левый указатель поворота, включен правый указатель поворота, перемещался ли автомобиль по горизонтали с течением времени. Вместо этого мы используем автоматическое обучение с помощью флота.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nКак это работает. Мы просим флот присылать нам данные всякий раз, когда зафиксировано перестроение в нашу полосу. Затем мы перематываем время назад и автоматически помечаем, что этот автомобиль через 1.3 сек перестроится перед вами. Эти данные можно использовать для обучения нейронной сети. Таким образом нейронная сеть сама извлечет нужные признаки. Например, машина рыскает и затем перестраивается, или у нее включен сигнал поворота. Обо всем этом нейросеть узнает из автоматически размеченных примеров. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch2\u003EПроверка в теневом режиме\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\nМы просим флот автоматически присылать нам данные. Мы можем собрать полмиллиона изображений или около того, и на всех будут размечены перестроения. Мы обучаем сеть и загружаем её во флот. Но пока не включаем её полностью, а запускаем в теневом режиме. В этом режиме сеть постоянно делает прогнозы: «эй, я думаю, этот автомобиль собирается перестроиться». И мы ищем ошибочные прогнозы.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fx0\u002Fzy\u002Fzx\u002Fx0zyzxkrebaxgrqwu3xdxuldf9u.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВот пример клипа, который мы получили из теневого режима. Здесь ситуация немного не очевидна, и сеть подумала, что автомобиль справа собирается перестроиться. И вы можете заметить, что он слегка заигрывает с линией разметки. Сеть среагировала на это, и предположила что автомобиль скоро окажется в нашей полосе. Но этого не произошло.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nСеть работает в теневом режиме и делает прогнозы. Среди них есть ложноположительные и ложноотрицательные. Иногда сеть ошибочно реагирует, а иногда, пропускает события. Всё эти ошибки запускают сбор данных. Данные размечаются и включаются в обучение без дополнительных усилий. И мы не подвергаем людей опасности в этом процессе. Мы переобучаем сеть и снова используем теневой режим. Можем повторять так несколько раз, оценивая ложные срабатывания в реальной дорожной обстановке. Как только показатели нас устраивают, мы просто щелкаем переключатель и позволяем сети контролировать автомобиль.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nМы запустили одну из первых версий детектора перестроений, примерно три месяца назад. Если вы заметили, что машина стала намного лучше обнаруживать перестроения — это и есть обучение с помощью флота в действии. И ни один человек не пострадал в этом процессе. Это просто много тренировок нейронных сетей, основанных на реальных данных, использование теневого режима и анализ результатов.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E Илон: \u003C\u002Fstrong\u003E По сути, все водители постоянно тренируют сеть. Не важно включен или выключен автопилот. Сеть обучается. Каждая миля, пройденная за машиной с оборудованием HW2.0 или выше, обучает сеть.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch2\u003EПока вы ведете машину, на самом деле вы размечаете данные\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002F-g\u002F1h\u002Fi8\u002F-g1hi870mojfe0cnotbafoab73u.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E Андрей: \u003C\u002Fstrong\u003E Другой интересный проект, который мы используем в схеме обучения флотом, это прогнозирование пути. Когда вы ведете машину, на самом деле, вы размечаете данные. Вы говорите нам, как вести машину в разной дорожной обстановке. Вот один из водителей повернул налево на перекрестке. У нас есть полное видео всех камер, и мы знаем, путь, который выбрал водитель. Мы также знаем какая была скорость и угол поворота рулевого колеса. Мы собираем все это вместе и понимаем путь, который выбрал человек в этой дорожной ситуации. И мы можем использовать это как обучение с учителем. Мы просто получаем нужный объем данных с флота, обучаем сеть на этих траекториях, и после этого нейронная сеть может прогнозировать путь.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЭто называют имитационным обучением (imitation learning). Мы берем траектории движения людей из реального мира и пытаемся подражать им. И мы снова можем применить наш итеративный подход.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВот пример предсказания пути в непростой дорожной обстановке. На видео мы накладываем прогноз сети. Зеленым выделен путь, по которому двигалась бы сеть.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fvq\u002F_5\u002Fh-\u002Fvq_5h-j22m3xlryz5aszlqqwls8.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E Илон: \u003C\u002Fstrong\u003E Безумие в том, что сеть предсказывает путь, который она даже не может видеть. С невероятно высокой точностью. Она не видит что за поворотом, но считает, что вероятность этой траектории чрезвычайно высока. И оказывается права. Сегодня вы увидите это в автомобилях, мы включим дополненное зрение, чтобы вы могли видеть разметку и прогнозы траектории, наложенные на видео. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E Андрей: \u003C\u002Fstrong\u003E На самом деле, под капотом происходит больше всего, и\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E Илон: \u003C\u002Fstrong\u003E Вообще-то, это немного пугает (Андрей смеется).\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E Андрей: \u003C\u002Fstrong\u003E Конечно, я пропускаю много деталей. Возможно, вы не захотите использовать для разметки всех водителей подряд, вы хотите подражать лучшим. И мы используем ряд способов, для подготовки этих данных. Интересно, что этот прогноз на самом деле является трехмерным. Это путь в трехмерном пространстве, который мы отображаем в 2D. Но у сети есть информация об уклоне, и это очень важно для вождения.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПрогнозирование пути на данный момент уже работает в автомобилях. Кстати, когда вы проезжали развязку на шоссе, месяцев пять назад, ваша машина не умела справляться с этим. Теперь может. Это прогнозирование пути, в действии, в ваших автомобилях. Мы включили его некоторое время назад. И сегодня вы сможете увидеть, как это работает на перекрестках. Значительная часть обучения преодолению перекрестков, получена путем автоматической разметки данных.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЯ успел рассказать о ключевых компонентах обучения нейросети. Вам нужен большой разнообразный набор реальных данных. В Tesla мы получаем его с помощью флота. Мы используем data engine, теневой режим и автоматическую разметку данных с помощью флота. И мы можем масштабировать этот подход.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch2\u003EВосприятие глубины по видео\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Foc\u002Fft\u002F4s\u002Focft4sltp3pprppnnk5y0jsj0rs.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ следующей части моего выступления расскажу о восприятии глубины с помощью зрения. Вам наверняка известно, что в автомобилях используются как минимум два типа сенсоров. Один — это видео камеры, работающие с яркостью, а другой — лидар, который используют многие компании. Лидар дает точечные измерения расстояния вокруг вас.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЯ хотел бы отметить, вы все приехали сюда, используя только свою нейронную сеть и зрение. Вы не стреляли лазерами из глаз и все равно оказались здесь.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЯсно, что человеческая нейронная сеть извлекает расстояние и воспринимает мир трехмерным исключительно с помощью зрения. Она использует ряд приемов. Я кратко расскажу о некоторых из них. Например у нас два глаза, поэтому вы получаете два изображения мира впереди вас. Ваш мозг объединяет эту информацию, чтобы получить оценку расстояний, это делается с помощью триангуляции точек на двух изображениях. У многих животных глаза расположены по бокам и их поле зрения слабо пересекается. Эти животные используют движение (structure from motion). Они двигают головой, чтобы получить множество изображений мира из разных точек и также могут применять триангуляцию.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fgl\u002Fsq\u002F-q\u002Fglsq-qyu337vx5gcd3bycvqaffu.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nДаже с одним закрытым глазом и будучи совершенно неподвижным, вы сохраняете некоторое ощущение восприятия расстояния. Если вы закроете один глаз, вам не станет казаться, что я стал на два метра ближе или на сто метров дальше. Это потому что есть много сильных монокулярных приемов, которые также применяет ваш мозг. Например распространенная оптическая иллюзия, с двумя одинаковыми полосами на фоне рельс. Ваш мозг оценивает сцену и ожидает, что одна из них будет больше другой из-за исчезающих вдали линий рельс. Ваш мозг делает много подобного автоматически, и искусственные нейронные сети тоже так могут. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЯ приведу три примера как можно добиться восприятия глубины по видео. Один классический подход и два на основе нейронных сетей.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fns\u002Fld\u002Fx0\u002Fnsldx0ejkyg1fvxoy-_7id-uds4.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nМы можем взять видео клип в несколько секунд и воссоздать окружение в 3D, используя триангуляцию и методы стереозрения. Мы применяем аналогичные методы в автомобиле. Главное, что в сигнале действительно есть нужная информация, вопрос только в том чтобы ее извлечь.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch2\u003EРазметка расстояния с помощью радара\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\nКак я сказал, нейронные сети являются очень мощным инструментом визуального распознавания. Если вы хотите, чтобы они распознавали расстояние, вам нужно разметить расстояния, и тогда сеть научится делать это. Ничто не ограничивает сети в способности прогнозировать расстояние, кроме наличия размеченных данных.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nМы используем радар, направленный вперед. Этот радар измеряет и размечает расстояние до объектов, которые видит нейросеть. Вместо того, чтобы люди говорили вам «этот автомобиль находятся примерно в 25 метрах», вы можете разметить данные гораздо лучше с помощью сенсоров. Радар, очень хорошо работает на таком расстоянии. Вы размечаете данные и обучаете нейронную сеть. Если у вас достаточно данных, нейронная сеть будет очень хорошо предсказывать расстояние.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fih\u002Fpp\u002Fje\u002Fihppjemgjkcaefowadynpdtu5le.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНа этом изображении кругами показаны объекты полученные радаром, а кубоиды — объекты полученные нейросетью. И если сеть работает хорошо, то на виде сверху, положения кубоидов должны совпадать с положением кружков, что мы и наблюдаем. Нейронные сети очень хорошо справляются с прогнозированием расстояния. Они могут выучить размеры разных транспортных средств, и по их размеру на изображении, довольно точно определять расстояние.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch2\u003ESelf-supervision\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\nПоследний механизм, о котором я расскажу очень кратко, немного более технический. Есть лишь несколько статей, в основном в последний год или два, об этом подходе. Он называется Self-supervision.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fll\u002Fvt\u002Fqy\u002Fllvtqyhtg50ssityr07udz-ssqs.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЧто здесь происходит. Вы загружаете сырые не размеченные видео в нейронную сеть. И сеть все равно может учиться распознавать расстояние. Не вдаваясь в подробности, идея состоит в том, что нейронная сеть предсказывает расстояние в каждом кадре этого видео. У нас нет меток для проверки, но есть цель — согласованность во времени. Какое бы расстояние сеть ни предсказывала, она должна быть последовательной на протяжении всего видео. И единственный способ быть последовательным — предсказывать расстояние правильно. Сеть автоматически предсказывает глубину для всех пикселей. Мы сумели это воспроизвести, и это работает довольно хорошо.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch2\u003EМощное визуальное распознавание — обязательное условие для автопилота\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\nПодытожим. Люди используют зрение, никаких лазеров. Я хочу подчеркнуть, что мощное визуальное распознавание, абсолютно необходимо для автономного вождения. Нам нужны нейронные сети, которые действительно понимают окружающую обстановку.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002F5q\u002Faq\u002Fb0\u002F5qaqb0qjwt-a7c6tpihpswc_zba.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nДанные с лидара гораздо меньше насыщены информацией. Этот силуэт на дороге, это пластиковый пакет или шина? Лидар просто даст вам несколько точек, в то время как зрение может сказать вам, что это. А этот парень на велосипеде оглядывающийся назад, он пытается перестроиться в вашу полосу или едет прямо? В зоне ремонта дороги, что означают эти знаки и как я должен вести себя здесь? Да вся дорожная инфраструктура предназначена для визуального потребления. Все знаки, светофоры, все предназначено для зрения, вот где вся информация. И мы должны использовать её.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЭта девушка увлеченная телефоном, она собирается ступить на проезжую часть? Ответы на подобные вопросы могут быть найдены только с помощью зрения и они необходимы для автопилота 4-5 уровня. И именно это мы разрабатываем в Tesla. Мы делаем это через крупномасштабное обучение нейронной сети, наш data engine и помощь флота.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ этом отношении лидар — попытка срезать путь. Он обходит фундаментальную задачу машинного зрения, решение которой необходимо для автономного вождения. Он дает ложное чувство прогресса. Лидар хорошо годится только для быстрых демонстраций.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch2\u003EПрогресс пропорционален частоте столкновений со сложными ситуациями в реальном мире\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002F1t\u002Fio\u002Fen\u002F1tioensdyfmt5eei36zaezrk1py.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЕсли бы я хотел бы уместить все сказанное на одном слайде, он выглядел бы так. Нам нужны системы 4-5 уровня, которые смогут обрабатывать все возможные ситуации в 99,9999% случаев. Погоня за последними девятками, будет сложной и очень сложной. Для этого потребуется очень мощная система машинного зрения.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЗдесь показаны изображения, которые вы можете встретить на пути к заветным знакам после запятой. Сначала у вас просто автомобили, едущие вперед, затем эти автомобили начинают выглядеть немного необычно, на них появляются велосипеды, автомобили на автомобилях. Дальше вы сталкиваетесь с действительно редкими событиями, такими как перевернутые автомобили или даже автомобили в прыжке. Мы встречаем много всякого, в данных приходящих от флота.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nИ мы видим эти редкие события гораздо чаще чем наши конкуренты. Это определяет скорость, с которой мы можем заполучить данные и устранить проблемы через обучение нейросетей. Скорость прогресса пропорциональна частоте, с которой вы сталкиваетесь со сложными ситуациями в реальном мире. И мы сталкиваемся с ними чаще, чем кто-либо еще. Поэтому наш автопилот лучше других. Спасибо.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch2\u003EВопросы и ответы\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E Вопрос: \u003C\u002Fstrong\u003E сколько данных вы собираете в среднем с каждого автомобиля?\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E Андрей: \u003C\u002Fstrong\u003E Дело не только в количестве данных, дело в разнообразии. В какой-то момент у вас уже достаточно изображений движения вперед по шоссе, сеть их понимает, больше не нужно. Поэтому стратегически мы сфокусированы на получении нужных данных. И наша инфраструктура, с довольно сложным анализом, позволяет нам получать те данные, которые нужны прямо сейчас. Это не про огромные объемы данных, это про очень хорошо отобранные данные.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E Вопрос: \u003C\u002Fstrong\u003E Мне интересно, как вы собираетесь решать проблему смены полосы движения. Всякий раз, когда я пытаюсь перестроиться в плотный поток, меня подрезают. Человеческое поведение становится иррациональным на дорогах Лос-Анджелеса. Автопилот хочет вести безопасно, а вам почти приходится делать это не безопасно.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E Андрей: \u003C\u002Fstrong\u003E Я говорил о data engine как об обучении нейронных сетей. Но мы делаем то же самое на уровне программного обеспечения. Все параметры, которые влияют на выбор, например, когда перестраиваться, насколько агрессивно. Мы также изменяем их в теневом режиме, и наблюдаем, насколько хорошо они работают и настраиваем эвристику. На самом деле проектирование подобных эвристик для общего случая, это трудноразрешимая задача. Я думаю, нам придется использовать обучение с помощью флота для принятия подобных решений. Когда люди перестраиваются в другую полосу? В каких сценариях? Когда они чувствуют, что смена полосы небезопасна? Давайте просто посмотрим на большой объем данных и обучим классификатор (machine learning classifier) различать, когда перестроение безопасно. Эти классификаторы смогут написать намного лучший код, чем люди, потому что они опираются на огромное количество данных о поведении водителей.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E Илон: \u003C\u002Fstrong\u003E Вероятно, у нас будет режим «трафик в Лос-Анджелесе». Где-то после режима «Безумный Макс». Даа, Безумному Максу пришлось бы несладко в Лос-Анджелесе.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E Андрей \u003C\u002Fstrong\u003E Придется идти на компромисс. Вы не хотите создавать небезопасные ситуации, но хотите доехать домой. И танцы которые люди исполняют при этом, это очень сложно запрограммировать. Я думаю, что правильный пусть — машинное обучение. Где мы просто смотрим на множество способов, которыми люди делают это и пытаемся имитировать их.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E Илон: \u003C\u002Fstrong\u003E Сейчас мы немного консервативны, и, по мере роста нашей уверенности, станет возможным выбирать более агрессивный режим. Пользователи смогут сами его выбирать. В агрессивных режимах, при попытке перестроиться в пробке, есть небольшая вероятность помять крыло. Без риска серьезной аварии. У вас будет выбор, согласны ли вы на ненулевой шанс помять крыло. К сожалению, это единственный способ передвижения в пробке на шоссе.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E Вопрос: \u003C\u002Fstrong\u003E Не случится ли так, на одной из тех девяток после запятой, что лидар окажется полезен? Второй вопрос, если лидары действительно бесполезны, что произойдет с теми, кто строит свои решения на них?\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E Илон: \u003C\u002Fstrong\u003E Они все избавятся от лидаров, это мой прогноз, можете записать. Я должен отметить, я не ненавижу лидар так сильно, как может показаться. SpaceX Dragon использует лидар для перемещения к МКС и стыковки. SpaceX разработала свой собственный лидар с нуля для этого. Я лично возглавлял этот проект, потому что в этом сценарии лидар имеет смысл. А в машинах это чертовски глупо. Это дорого и не нужно. И, как сказал Андрей, как только вы справитесь с видео, лидар станет бесполезен. У вас будет дорогое оборудование, которое бесполезно для автомобиля.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nУ нас есть радар направленный вперед. Он недорогой и полезен, особенно в условиях плохой видимости. Туман, пыль или снег, радар может видеть сквозь них. Если уж вы собираетесь использовать активную генерацию фотонов, не используйте длину волны видимого света. Потому что, обладая пассивной оптикой, вы уже позаботились обо всем в видимом спектре. Теперь лучше используйте длину волны, с хорошими проникающими свойствами, например радар. Лидар это просто активная генерация фотонов в видимом спектре. Хотите активно генерировать фотоны, делайте это вне видимого спектра. Используя 3.8 мм против 400-700 нм вы получите возможность видеть в плохих погодных условиях. Поэтому у нас есть радар. А также двенадцать ультразвуковых датчиков для ближнего окружения. Радар наиболее полезен в направлении движения, потому что именно прямо вы движетесь очень быстро.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nМы поднимали вопрос сенсоров много раз. Достаточно ли их? Есть ли у нас есть все что нужно? Нужно добавить что-то еще? Хммм. Достаточно.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E Вопрос: \u003C\u002Fstrong\u003E Похоже, что автомобили производят какие-то вычисления, чтобы определить, какую информацию вам отправить. Это делается в режиме реального времени или на основе сохраненной информации?\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E Андрей: \u003C\u002Fstrong\u003E Вычисления производятся в режиме реального времени в самих автомобилях. Мы передаем условия, которые нас интересуют, а автомобили делают все нужные вычисления. Если бы они этого не делали, нам пришлось бы передавать все данные подряд и обрабатывать их в нашем бэк-энде. Мы не хотим этого делать.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E Илон: \u003C\u002Fstrong\u003E У нас есть четыреста двадцать пять тысяч автомобилей с HW2.0+. Это означает, что в них есть восемь камер, радар, ультразвуковые датчики и по крайней мере компьютер nVidia. Его достаточно, чтобы вычислить, какая информация важна, а какая нет. Они сжимают важную информацию и отправляют ее в сеть для обучения. Это огромная степень сжатия данных из реального мира.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E Вопрос: \u003C\u002Fstrong\u003E У вас есть эта сеть из сотен тысяч компьютеров, которая напоминает мощный распределенный ЦОД. Видите ли вы её применение для целей, отличных от автопилота?\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E Илон: \u003C\u002Fstrong\u003E Я полагаю, это можно было бы использовать для чего-то еще. Пока мы сосредоточены на автопилоте. Как только доведем его до нужного уровня, сможем подумать о других применениях. К тому времени это будут миллионы или десятки миллионов машин с HW3.0 или FSDC.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E Вопрос: \u003C\u002Fstrong\u003E Вычисление дорожного трафика?\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E Илон: \u003C\u002Fstrong\u003E Да, может быть. это может быть что-то вроде AWS (Amazon Web Services).\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E Вопрос: \u003C\u002Fstrong\u003E Я водитель Model 3 в Миннесоте, где много снега. Камера и радар не могут видеть дорожную разметку сквозь снег. Как вы собираетесь решать подобную проблему? Будете использовать GPS высокой точности?\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E Андрей: \u003C\u002Fstrong\u003E Уже сегодня автопилот довольно неплохо ведется себя на заснеженной дороге. Даже когда разметка скрыта, или истертая, или покрыта водой в сильный дождь, все равно автопилот ведет себя относительно хорошо. Мы пока еще специально не обрабатывали заснеженную дорогу с помощью нашего data engine. Но я уверен, что эта задача поддается решению. Потому что на многих изображениях заснеженной дороги, если вы спросите человека, где должна быть разметка, он покажет её вам. Люди соглашаются в том где провести линии разметки. И пока люди могут прийти к согласию и разметить ваши данные, нейронная сеть сможет этому научится и будет хорошо работать. Вопрос только в том есть ли достаточно информации в исходном сигнале. Достаточно для человека аннотатора? Если ответ да, то нейронная сеть справится с этим просто отлично.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E Илон: \u003C\u002Fstrong\u003E В исходном сигнале есть несколько важных источников информации. Так разметка, это лишь один из них. Самый важный источник это проезжая часть (drive space). Где можно ехать, а где нельзя. Гораздо важнее разметки. Распознавание проезжей части работает очень хорошо. Я думаю, особенно после предстоящей зимы, будет работать просто невероятно. Мы будем удивляться, как это может настолько хорошо работать. Это просто безумие.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E Андрей: \u003C\u002Fstrong\u003E Дело даже не в возможности людей нанести разметку. До тех пор, пока вы, человек, можете преодолеть этот участок дороги. Флот будет учиться у вас. Мы знаем как вы проехали здесь. И вы, очевидно, использовали зрение для этого. Вы не видели разметку, но использовали геометрию всей сцены. Вы видите, как дорога изгибается, как другие машины расположены вокруг вас. Нейронная сеть автоматически выделит все эти шаблоны, нужно только получить достаточно данных о том, как люди преодолевают подобные ситуации.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E Илон: \u003C\u002Fstrong\u003E Очень важно не привязываться жестко к GPS. Ошибка GPS может быть весьма существенной. И реальная дорожная ситуация может быть непредсказуемой. Это может быть ремонт дороги или объезд. Если автомобиль слишком сильно полагается на GPS, это плохая ситуация. Вы напрашиваетесь на неприятности. GPS хорошо использовать только как подсказку.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E Вопрос: \u003C\u002Fstrong\u003E Некоторые из ваших конкурентов рассказывают о том, как они используют карты высокого разрешения (high definition maps) для улучшения восприятия и планирования пути. Используете ли вы что-то подобное в своей системе, видите ли вы в этом какую-то пользу? Есть ли области, где вы хотели бы иметь больше данных, не от флота, а что-то наподобие карт?\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E Илон: \u003C\u002Fstrong\u003E Я думаю, карты высокого разрешения — это очень плохая затея. Система становится чрезвычайно неустойчивой. Не способной адаптироваться к изменениям, если вы привязаны к GPS и картам высокого разрешения и не отдаете приоритет зрению. Зрение это та вещь, которая должна делать все. Смотрите, разметка это просто ориентир, а не самая важная вещь. Мы пробовали использовать карты разметки и быстро поняли, что это большая ошибка. Мы полностью отказались от них.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E Вопрос: \u003C\u002Fstrong\u003E Понимание того, где находятся объекты и как движутся машины это все очень полезно. Но как быть с переговорным аспектом? Во время парковки, на кольцевых развязках и в других ситуациях, где вы взаимодействуете с другими автомобилями, и которыми управляют люди. Это скорее искусство, чем наука.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E Илон: \u003C\u002Fstrong\u003E Это работает довольно хорошо. Если смотреть на ситуации с перестроениями и т.п., автопилот нормально справляется.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E Андрей: \u003C\u002Fstrong\u003E Сейчас мы используем много машинного обучения для создания представления о реальном мире. Поверх этого у нас есть планировщик и контроллер и множество эвристик о том, как ехать, как учитывать другие автомобили и так далее. И также как в распознавании образов здесь есть множество нестандартных случаев, это как игра ястребы и голуби, в которую вы играете с другими людьми. Мы уверены, что в конечном итоге мы используем обучение с помощью флота для решения этой задачи. Ручное написание эвристик быстро упирается в плато.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E Вопрос: \u003C\u002Fstrong\u003E у вас есть режим автоколонны (platooning)? Система способна на это?\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E Андрей: \u003C\u002Fstrong\u003E Я абсолютно уверен, что мы могли бы сделать такой режим. Но опять, если вы просто обучаете сеть подражать людям. Люди пристраиваются и едут за автомобилем впереди и сеть запоминает это поведение. В этом есть своего рода волшебство, все происходит само собой. Разные проблемы сводятся к одной, просто соберите набор данных и используете его для обучения нейронной сети.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E Илон: \u003C\u002Fstrong\u003E Три шага к автономному вождению. Первый — просто реализовать эту функциональность. Второй — довести её до такой степени, когда человеку в машине вообще не нужно обращать внимание на дорогу. И третий — показать уровень надежности, который убедит регуляторов. Это три уровня. Мы ожидаем в этом году достигнуть первого уровня. И мы рассчитываем, где-то во втором квартале следующего года достигнуть уровня уверенности, когда человеку больше не нужно держать руки на руле и смотреть на дорогу. После этого мы ожидаем получить одобрение регулирующих органов, по крайней мере, в некоторых юрисдикциях к концу следующего года. Это мои ожидания.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВероятно, для грузовых автомобилей, режим автоколонны будет одобрен регулирующими органами раньше всего остального. Возможно, для дальних поездок вы сможете использовать одного водителя в головной машине, и 4 грузовика Semi позади него в режиме автоколонны.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E Вопрос: \u003C\u002Fstrong\u003E Я очень впечатлён улучшением автопилота. На прошлой неделе я ехал в правой полосе автомагистрали, и там был въезд. Моя Model 3 смогла обнаружить две машины въезжающие на магистраль и сбавила скорость так, что одна машина спокойно встроилась передо мной, а другая позади меня. Я тогда подумал, черт побери, это безумие, я не знал, что моя Model 3 способна на такое.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНо на той же неделе я снова ехал в правой полосе, и там было сужение, моя правая полоса сливалась с левой. И моя Model 3 не смогла правильно среагировать, мне пришлось вмешаться. Можете рассказать, как Tesla может решить эту проблему?\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E Андрей: \u003C\u002Fstrong\u003E Я рассказывал про инфраструктуру сбора данных. Если вы вмешались, то, скорее всего, мы получили этот клип. Он попал в статистку, например, с какой вероятностью мы корректно вливаемся в поток. Мы смотрим на эти цифры, смотрим на клипы, и мы видим что не так. И мы пытаемся исправить поведение, чтобы добиться улучшения в сравнении с контрольными показателями.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E Илон: \u003C\u002Fstrong\u003E Хорошо, у нас есть еще одна презентация, посвященная программному обеспечению. У нас была презентация про оборудование с Питом, потом нейронные сети с Андреем, а теперь следует программное обеспечение со Стюартом.\u003Cbr\u002F\u003E\r\n…\u003C\u002Fdiv\u003E","tags":[{"titleHtml":"Tesla"},{"titleHtml":"автопилот"},{"titleHtml":"искусственный интеллект"},{"titleHtml":"машинное обучение"},{"titleHtml":"нейронные сети"}],"metadata":{"stylesUrls":[],"scriptUrls":[],"shareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F450796\u002F94c8ce5e2078c2c1f4914f2d7cbd3880\u002F","shareImageWidth":1200,"shareImageHeight":630,"vkShareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F450796\u002F94c8ce5e2078c2c1f4914f2d7cbd3880\u002F?format=vk","schemaJsonLd":"{\"@context\":\"http:\\\u002F\\\u002Fschema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F450796\\\u002F\"},\"headline\":\"Как Tesla обучает автопилот\",\"datePublished\":\"2019-05-13T09:36:14+03:00\",\"dateModified\":\"2019-05-15T23:11:50+03:00\",\"author\":{\"@type\":\"Person\",\"name\":\"Andrei Odue\"},\"publisher\":{\"@type\":\"Organization\",\"name\":\"Habr\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fa_\\\u002Flk\\\u002F9m\\\u002Fa_lk9mjkccjox-zccjrpfolmkmq.png\"}},\"description\":\"Расшифровка 2-й части Tesla Autonomy Investor Day. Цикл обучения автопилота, инфраструктура сбора данных, автоматическая разметка данных, подражание водителям-...\",\"url\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F450796\\\u002F#post-content-body\",\"about\":[\"h_bigdata\",\"h_machine_learning\",\"h_artificial_intelligence\",\"h_transport\",\"h_futurenow\",\"f_develop\",\"f_popsci\"],\"image\":[\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fvc\\\u002Fch\\\u002Flx\\\u002Fvcchlxqf5blytupr3nsndhmmgay.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Flu\\\u002F-b\\\u002F-u\\\u002Flu-b-ufhozioprg2nvebadsk4zs.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fx7\\\u002Fsy\\\u002Fzq\\\u002Fx7syzqa6mvf_64j6nsk8dovzyww.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Feq\\\u002Fwa\\\u002Fwo\\\u002Feqwawo_3ky3vffm_hkkheyrhmlq.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002F_9\\\u002F4u\\\u002Fx2\\\u002F_94ux28ucicihvbggphmoqc5i0y.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fe5\\\u002Few\\\u002Fd3\\\u002Fe5ewd3fhqw_ebegpk0heamyjafk.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fk4\\\u002Fog\\\u002F1f\\\u002Fk4og1fzgiwwt6jy_rwcefm3fndm.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fob\\\u002Fhe\\\u002Fxw\\\u002Fobhexwtzhagxn7n_z0ildcfzyl8.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002F2k\\\u002F3r\\\u002F7a\\\u002F2k3r7as1159puh5ad4bf3fwrltc.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002F8u\\\u002Fkj\\\u002Fh7\\\u002F8ukjh7k3qw7-sv469pyhnnbwhi0.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002F7h\\\u002Fst\\\u002Fqk\\\u002F7hstqk7ygew-tfoo_ibersaw86s.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fms\\\u002Fd0\\\u002Foi\\\u002Fmsd0oiytsgapqj3dczs6s_hpocc.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fyt\\\u002Fxh\\\u002Fuj\\\u002Fytxhujmzul8r8dpqwido3fr_rns.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Faa\\\u002Fne\\\u002F2x\\\u002Faane2xostifrgw-xjzwcklq-zbm.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fzl\\\u002Fze\\\u002Faz\\\u002Fzlzeazzv1wrzsxbntqq5wtw0-50.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fjk\\\u002F-g\\\u002Fy4\\\u002Fjk-gy4iyujnhhwpmzb0lcwpggci.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fx0\\\u002Fzy\\\u002Fzx\\\u002Fx0zyzxkrebaxgrqwu3xdxuldf9u.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002F-g\\\u002F1h\\\u002Fi8\\\u002F-g1hi870mojfe0cnotbafoab73u.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fvq\\\u002F_5\\\u002Fh-\\\u002Fvq_5h-j22m3xlryz5aszlqqwls8.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Foc\\\u002Fft\\\u002F4s\\\u002Focft4sltp3pprppnnk5y0jsj0rs.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fgl\\\u002Fsq\\\u002F-q\\\u002Fglsq-qyu337vx5gcd3bycvqaffu.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fns\\\u002Fld\\\u002Fx0\\\u002Fnsldx0ejkyg1fvxoy-_7id-uds4.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fih\\\u002Fpp\\\u002Fje\\\u002Fihppjemgjkcaefowadynpdtu5le.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fll\\\u002Fvt\\\u002Fqy\\\u002Fllvtqyhtg50ssityr07udz-ssqs.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002F5q\\\u002Faq\\\u002Fb0\\\u002F5qaqb0qjwt-a7c6tpihpswc_zba.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002F1t\\\u002Fio\\\u002Fen\\\u002F1tioensdyfmt5eei36zaezrk1py.png\"]}","metaDescription":"Расшифровка 2-й части Tesla Autonomy Investor Day. Цикл обучения автопилота, инфраструктура сбора данных, автоматическая разметка данных, подражание водителям-людям, определение расстояния по...","mainImageUrl":null,"amp":true},"polls":[],"commentsEnabled":true,"rulesRemindEnabled":false,"votesEnabled":true,"status":"published","plannedPublishTime":null,"checked":null,"isEditorial":false}},"articlesIds":{},"isLoading":false,"pagesCount":{},"route":{},"reasonsList":null,"view":"cards","lastVisitedRoute":{},"ssrCommentsArticleIds":[""],"karma":{}},"authorContribution":{"authors":{}},"betaTest":{"currentAnnouncement":null,"announcements":{},"announcementCards":null,"announcementComments":{},"announcementCommentThreads":{},"announcementCommentingStatuses":{},"archivedList":[]},"authorStatistics":{"articleRefs":{},"articleIds":{},"pagesCount":{},"route":{},"viewsCount":[],"maxStatsCount":{}},"career":{"seoLandings":[],"hubs":"bigdata,machine_learning,artificial_intelligence,transport,futurenow"},"comments":{"articleComments":{},"searchCommentsResults":null,"previewComment":null,"pagesCount":null,"commentAccess":{},"scrollParents":{},"pageArticleComments":{"lastViewedComment":0,"postId":null,"lastCommentTimestamp":"","moderated":[],"moderatedIds":[],"commentRoute":""}},"companies":{"companyRefs":{},"companyIds":{},"companyTopIds":{},"pagesCount":{},"companyProfiles":{},"companiesCategories":[],"companiesCategoriesTotalCount":0,"companiesWidgets":{},"companiesWorkers":{},"companiesFans":{},"route":{},"isLoading":false,"companyWorkersLoading":false,"companyFansLoading":false,"vacancies":{}},"companiesContribution":{"hubs":{},"flows":{},"companyRefs":{}},"companyHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"conversation":{"messages":[],"respondent":null,"isLoadMore":false},"conversations":{"conversations":[],"unreadCount":0,"pagesCount":0,"isLoadMore":false},"desktopState":{"desktopFl":null,"desktopHl":null,"isChecked":false,"isLoginDemanded":false},"dfp":{"slotsDict":{}},"docs":{"menu":{},"articles":{},"mainMenu":[],"loading":{"main":false,"dropdown":false,"article":false}},"feature":{"isProbablyVisible":"true"},"flows":{"flows":[{"alias":"develop","id":1,"route":{"name":"FLOW_PAGE","params":{"flowName":"develop"}}},{"alias":"admin","id":6,"route":{"name":"FLOW_PAGE","params":{"flowName":"admin"}}},{"alias":"design","id":2,"route":{"name":"FLOW_PAGE","params":{"flowName":"design"}}},{"alias":"management","id":3,"route":{"name":"FLOW_PAGE","params":{"flowName":"management"}}},{"alias":"marketing","id":4,"route":{"name":"FLOW_PAGE","params":{"flowName":"marketing"}}},{"alias":"popsci","id":7,"route":{"name":"FLOW_PAGE","params":{"flowName":"popsci"}}}]},"global":{"isPwa":false,"device":"desktop","isHabrCom":true},"hubs":{"hubRefs":{},"hubIds":{},"pagesCount":{},"isLoading":false,"route":{}},"hubsBlock":{"hubRefs":{},"hubIds":{}},"i18n":{"fl":"ru","hl":"ru"},"info":{"infoPage":{},"isLoading":true},"location":{"urlStruct":{"protocol":null,"slashes":null,"auth":null,"host":null,"port":null,"hostname":null,"hash":null,"search":null,"query":{},"pathname":null,"path":null,"href":""},"searchQuery":null},"me":{"user":null,"ppgDemanded":false,"karmaResetInfo":{"canReincarnate":null,"wasReincarnated":null,"currentScore":null},"notes":null},"mostReadingList":{"mostReadingListIds":[],"mostReadingListRefs":null,"promoPost":null},"pinnedPost":{"pinnedPost":null},"ppa":{"articles":{},"card":null,"transactions":null,"totalTransactions":null,"isAccessible":null},"projectsBlocks":{"activeBlocks":{}},"pullRefresh":{"shouldRefresh":false},"sandbox":{"articleIds":[],"articleRefs":{},"pagesCount":null,"route":{},"lastVisitedRoute":{},"isLoading":false},"settingsOther":{"inputs":{"uiLang":{"errors":[],"ref":null,"value":""},"articlesLangEnglish":{"errors":[],"ref":null,"value":false},"articlesLangRussian":{"errors":[],"ref":null,"value":false},"agreement":{"errors":[],"ref":null,"value":false},"email":{"errors":[],"ref":null,"value":true},"digest":{"errors":[],"ref":null,"value":true}}},"similarList":{"similarListIds":[],"similarListRefs":null},"ssr":{"error":null,"isDataLoaded":false,"isDataLoading":false,"isHydrationFailed":false,"isServer":false},"userHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"userInvites":{"availableInvites":0,"usedInvitesIds":[],"usedInvitesRefs":{},"usedInvitesPagesCount":0,"unusedInvitesIds":[],"unusedInvitesRefs":{},"unusedInvitesPagesCount":0},"users":{"authorRefs":{},"authorIds":{},"pagesCount":{},"authorProfiles":{},"userHubs":{},"userInvitations":{},"authorFollowers":{},"authorFollowed":{},"karmaStats":[],"statistics":null,"isLoading":false,"authorFollowersLoading":false,"authorFollowedLoading":false,"userHubsLoading":false,"userInvitationsLoading":false,"route":{}},"viewport":{"prevScrollY":{},"scrollY":0,"width":0},"tracker":{"items":{},"pagesCache":{},"markedViewedSilently":{},"markedRead":{},"unreadCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null},"unviewedCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null}}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script>
<script src="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" defer></script><script src="https://assets.habr.com/habr-web/js/app.c0af73e7.js" defer></script>



    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    </script>
  
  <script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(24049213, "init", {
      defer:true,
      trackLinks:true,
      accurateTrackBounce:true,
      webvisor:false,
    });
  </script>
  <noscript>
    <div>
      <img src="https://mc.yandex.ru/watch/24049213" style="position:absolute; left:-9999px;" alt="" />
    </div>
  </noscript>
  
    <script type="text/javascript">
      window.addEventListener('load', function () {
        setTimeout(() => {
          const img = new Image();
          img.src = 'https://vk.com/rtrg?p=VK-RTRG-421343-57vKE';
        }, 0);
      });
    </script>
  
</body>
</html>
